
var g_root=false,g_msgtimeout=null,g_spinnerid=null,g_switch=0,g_title=document.title,g_emptyguid='00000000-0000-0000-0000-000000000000',g_checkmessageDoing=false,g_checkmessageInterval=30000,g_tab=0,g_sub=0;var User=(function(){function User(id,no,name,email,popup){this.ID=id||g_emptyguid;this.No=no||'0000000';this.Name=name||'火星用户';this.Email=email||'';this.Popup=popup||'';}
User.prototype.isLogin=function(){return this.ID!=g_emptyguid;};User.prototype.isPopup=function(){return this.Popup!='False';};return User;})();var Jyeoo=(function(){function Jyeoo(){this.user=new User();}
Jyeoo.prototype.setUser=function(id,no,name,email,popup){this.user=new User(id,no,name,email,popup);};Jyeoo.prototype.isLogin=function(){return this.user.isLogin();};Jyeoo.prototype.isPopup=function(){return this.user.isPopup();};return Jyeoo;})();var QP=(function(){function QP(u){var i=u.indexOf('?'),s=i==-1?u:u.split('?')[1],ps=s.split('&'),l=ps.length,a,n,v;for(var i=0;i<l;i++){a=ps[i].split("=");n=decodeURIComponent(a[0]);v=decodeURIComponent(a[1]);this[n]=v;}}
return QP;})();var jyeoo=new Jyeoo();(function(b){var l="function",j="password",d="maxLength",f="type",c=true,a="",e=false,t="watermark",u,m=t,i="watermarkClass",q="watermarkFocus",k="watermarkSubmit",o="watermarkMaxLength",h="watermarkPassword",g="watermarkText",s=":data("+m+")",n=":text,:password,:search,textarea",p=["Page_ClientValidate"],r=e;b.extend(b.expr[":"],{search:function(b){return"search"===(b.type||a)},data:function(g,i,h){var f,d=/^((?:[^=!^$*]|[!^$*](?!=))+)(?:([!^$*]?=)(.*))?$/.exec(h[3]);if(d){f=b(g).data(d[1]);if(f!==u){if(d[2]){f=a+f;switch(d[2]){case"=":return f==d[3];case"!=":return f!=d[3];case"^=":return f.slice(0,d[3].length)==d[3];case"$=":return f.slice(-d[3].length)==d[3];case"*=":return f.indexOf(d[3])!==-1}}return c}}return e}});b.watermark={version:"3.0.6",options:{className:t,useNative:c},hide:function(a){b(a).filter(s).each(function(){b.watermark._hide(b(this))})},_hide:function(b,n){var m=b.val()||a,k=b.data(g)||a,l=b.data(o)||0,j=b.data(i);if(k.length&&m==k){b.val(a);if(b.data(h))if((b.attr(f)||a)==="text"){var e=b.data(h)||[],c=b.parent()||[];if(e.length&&c.length){c[0].removeChild(b[0]);c[0].appendChild(e[0]);b=e}}if(l){b.attr(d,l);b.removeData(o)}if(n){b.attr("autocomplete","off");window.setTimeout(function(){b.select()},1)}}j&&b.removeClass(j)},show:function(a){b(a).filter(s).each(function(){b.watermark._show(b(this))})},_show:function(e){var t=e.val()||a,k=e.data(g)||a,p=e.attr(f)||a,s=e.data(i);if((t.length==0||t==k)&&!e.data(q)){r=c;if(e.data(h))if(p===j){var n=e.data(h)||[],m=e.parent()||[];if(n.length&&m.length){m[0].removeChild(e[0]);m[0].appendChild(n[0]);e=n;e.attr(d,k.length)}}if(p==="text"||p==="search"){var l=e.attr(d)||0;if(l>0&&k.length>l){e.data(o,l);e.attr(d,k.length)}}s&&e.addClass(s);e.val(k)}else b.watermark._hide(e)},hideAll:function(){if(r){b.watermark.hide(n);r=e}},showAll:function(){b.watermark.show(n)}};b.fn.watermark=function(r,o){var p="string";if(!this.length)return this;var s=e,t=typeof r===p;if(typeof o==="object"){s=typeof o.className===p;o=b.extend({},b.watermark.options,o)}else if(typeof o===p){s=c;o=b.extend({},b.watermark.options,{className:o})}else o=b.watermark.options;if(typeof o.useNative!==l)o.useNative=o.useNative?function(){return c}:function(){return e};return this.each(function(){var v="dragleave",u="dragenter",x=this,e=b(x);if(!e.is(n))return;if(e.data(m)){if(t||s){b.watermark._hide(e);t&&e.data(g,r);s&&e.data(i,o.className)}}else{if(o.useNative.call(x,e))if((a+e.css("-webkit-appearance")).replace("undefined",a)!==a&&(e.attr("tagName")||a)!=="TEXTAREA"){t&&e.attr("placeholder",r);return}e.data(g,t?r:a);e.data(i,o.className);e.data(m,1);if((e.attr(f)||a)===j){var y=e.wrap("<span>").parent(),l=b(y.html().replace(/type=["']?password["']?/i,'type="text"'));l.data(g,e.data(g));l.data(i,e.data(i));l.data(m,1);l.attr(d,r.length);l.focus(function(){b.watermark._hide(l,c)}).bind(u,function(){b.watermark._hide(l)}).bind("dragend",function(){window.setTimeout(function(){l.blur()},1)});e.blur(function(){b.watermark._show(e)}).bind(v,function(){b.watermark._show(e)});l.data(h,e);e.data(h,l)}else e.focus(function(){e.data(q,1);b.watermark._hide(e,c)}).blur(function(){e.data(q,0);b.watermark._show(e)}).bind(u,function(){b.watermark._hide(e)}).bind(v,function(){b.watermark._show(e)}).bind("dragend",function(){window.setTimeout(function(){b.watermark._show(e)},1)}).bind("drop",function(c){var b=c.originalEvent.dataTransfer.getData("Text");e.val().replace(b,a)===e.data(g)&&e.val(b);e.focus()});if(x.form){var p=x.form,w=b(p);if(!w.data(k)){w.submit(b.watermark.hideAll);if(p.submit){w.data(k,p.submit);p.submit=function(c,a){return function(){var d=a.data(k);b.watermark.hideAll();if(d.apply)d.apply(c,Array.prototype.slice.call(arguments));else d()}}(p,w)}else{w.data(k,1);p.submit=function(a){return function(){b.watermark.hideAll();delete a.submit;a.submit()}}(p)}}}}b.watermark._show(e)})};p.length&&b(function(){for(var a,c,d=p.length-1;d>=0;d--){a=p[d];c=window[a];if(typeof c===l)window[a]=function(a){return function(){b.watermark.hideAll();return a.apply(null,Array.prototype.slice.call(arguments))}}(c)}})})(jQuery);;(function(f){f.fn.drag=function(b,a,d){var e=typeof b=="string"?b:"",k=f.isFunction(b)?b:f.isFunction(a)?a:null;if(e.indexOf("drag")!==0)e="drag"+e;d=(b==k?a:d)||{};return k?this.bind(e,d,k):this.trigger(e)};var i=f.event,h=i.special,c=h.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:false,drop:true,click:false},datakey:"dragdata",livekey:"livedrag",add:function(b){var a=f.data(this,c.datakey),d=b.data||{};a.related+=1;if(!a.live&&b.selector){a.live=true;i.add(this,"draginit."+c.livekey,c.delegate)}f.each(c.defaults,function(e){if(d[e]!==undefined)a[e]=d[e]})},remove:function(){f.data(this,c.datakey).related-=1},setup:function(){if(!f.data(this,c.datakey)){var b=f.extend({related:0},c.defaults);f.data(this,c.datakey,b);i.add(this,"mousedown",c.init,b);this.attachEvent&&this.attachEvent("ondragstart",c.dontstart)}},teardown:function(){if(!f.data(this,c.datakey).related){f.removeData(this,c.datakey);i.remove(this,"mousedown",c.init);i.remove(this,"draginit",c.delegate);c.textselect(true);this.detachEvent&&this.detachEvent("ondragstart",c.dontstart)}},init:function(b){var a=b.data,d;if(!(a.which>0&&b.which!=a.which))if(!f(b.target).is(a.not))if(!(a.handle&&!f(b.target).closest(a.handle,b.currentTarget).length)){a.propagates=1;a.interactions=[c.interaction(this,a)];a.target=b.target;a.pageX=b.pageX;a.pageY=b.pageY;a.dragging=null;d=c.hijack(b,"draginit",a);if(a.propagates){if((d=c.flatten(d))&&d.length){a.interactions=[];f.each(d,function(){a.interactions.push(c.interaction(this,a))})}a.propagates=a.interactions.length;a.drop!==false&&h.drop&&h.drop.handler(b,a);c.textselect(false);i.add(document,"mousemove mouseup",c.handler,a);return false}}},interaction:function(b,a){return{drag:b,callback:new c.callback,droppable:[],offset:f(b)[a.relative?"position":"offset"]()||{top:0,left:0}}},handler:function(b){var a=b.data;switch(b.type){case!a.dragging&&"mousemove":if(Math.pow(b.pageX-a.pageX,2)+Math.pow(b.pageY-a.pageY,2)<Math.pow(a.distance,2))break;b.target=a.target;c.hijack(b,"dragstart",a);if(a.propagates)a.dragging=true;case"mousemove":if(a.dragging){c.hijack(b,"drag",a);if(a.propagates){a.drop!==false&&h.drop&&h.drop.handler(b,a);break}b.type="mouseup"}case"mouseup":i.remove(document,"mousemove mouseup",c.handler);if(a.dragging){a.drop!==false&&h.drop&&h.drop.handler(b,a);c.hijack(b,"dragend",a)}c.textselect(true);if(a.click===false&&a.dragging){jQuery.event.triggered=true;setTimeout(function(){jQuery.event.triggered=false},20);a.dragging=false}break}},delegate:function(b){var a=[],d,e=f.data(this,"events")||{};f.each(e.live||[],function(k,j){if(j.preType.indexOf("drag")===0)if(d=f(b.target).closest(j.selector,b.currentTarget)[0]){i.add(d,j.origType+"."+c.livekey,j.origHandler,j.data);f.inArray(d,a)<0&&a.push(d)}});if(!a.length)return false;return f(a).bind("dragend."+c.livekey,function(){i.remove(this,"."+c.livekey)})},hijack:function(b,a,d,e,k){if(d){var j={event:b.originalEvent,type:b.type},n=a.indexOf("drop")?"drag":"drop",l,o=e||0,g,m;e=!isNaN(e)?e:d.interactions.length;b.type=a;b.originalEvent=null;d.results=[];do if(g=d.interactions[o])if(!(a!=="dragend"&&g.cancelled)){m=c.properties(b,d,g);g.results=[];f(k||g[n]||d.droppable).each(function(q,p){l=(m.target=p)?i.handle.call(p,b,m):null;if(l===false){if(n=="drag"){g.cancelled=true;d.propagates-=1}if(a=="drop")g[n][q]=null}else if(a=="dropinit")g.droppable.push(c.element(l)||p);if(a=="dragstart")g.proxy=f(c.element(l)||g.drag)[0];g.results.push(l);delete b.result;if(a!=="dropinit")return l});d.results[o]=c.flatten(g.results);if(a=="dropinit")g.droppable=c.flatten(g.droppable);a=="dragstart"&&!g.cancelled&&m.update()}while(++o<e);b.type=j.type;b.originalEvent=j.event;return c.flatten(d.results)}},properties:function(b,a,d){var e=d.callback;e.drag=d.drag;e.proxy=d.proxy||d.drag;e.startX=a.pageX;e.startY=a.pageY;e.deltaX=b.pageX-a.pageX;e.deltaY=b.pageY-a.pageY;e.originalX=d.offset.left;e.originalY=d.offset.top;e.offsetX=b.pageX-(a.pageX-e.originalX);e.offsetY=b.pageY-(a.pageY-e.originalY);e.drop=c.flatten((d.drop||[]).slice());e.available=c.flatten((d.droppable||[]).slice());return e},element:function(b){if(b&&(b.jquery||b.nodeType==1))return b},flatten:function(b){return f.map(b,function(a){return a&&a.jquery?f.makeArray(a):a&&a.length?c.flatten(a):a})},textselect:function(b){f(document)[b?"unbind":"bind"]("selectstart",c.dontstart).attr("unselectable",b?"off":"on").css("MozUserSelect",b?"":"none")},dontstart:function(){return false},callback:function(){}};c.callback.prototype={update:function(){h.drop&&this.available.length&&f.each(this.available,function(b){h.drop.locate(this,b)})}};h.draginit=h.dragstart=h.dragend=c})(jQuery);(function($){var reEscape=new RegExp('(\\'+['/','.','*','+','?','|','(',')','[',']','{','}','\\'].join('|\\')+')','g');function fnFormatResult(value,data,currentValue){var pattern='('+currentValue.replace(reEscape,'\\$1')+')';return value.replace(new RegExp(pattern,'gi'),'<strong class="ab">$1<\/strong>');};function Autocomplete(el,options){this.el=$(el);this.el.attr('autocomplete','off');this.suggestions=[];this.selectedIndex=-1;this.currentValue=this.el.val();this.source=options.source;this.options={minChars:1,maxHeight:300,width:0,highlight:true,onParams:function(){return{term:''};},fnFormatResult:fnFormatResult,delimiter:null,zIndex:9999};this.initialize(options);};$.fn.autocomplete=function(options){return this.each(function(){var ac=new Autocomplete(this,options);$.data(this,"Autocomplete",ac);});};Autocomplete.prototype={initialize:function(options){var me=this,containerID='AC_'+Math.floor(Math.random()*0x100000).toString(16);if(!this.options.width){this.options.width=this.el.width();}
$.extend(this.options,options);this.container=$('<div id="'+containerID+'"class="autocomplete"></div>').css({zIndex:this.options.zIndex,maxHeight:this.options.maxHeight,width:this.options.width}).appendTo(document.body);this.fixOffset();if(window.opera){this.el.keypress(function(e){me.onKeyPress(e);});}else{this.el.keydown(function(e){me.onKeyPress(e);});}
this.el.keyup(function(e){me.onKeyUp(e);});this.el.focus(function(){me.fixOffset();});$(document).mousedown(function(ev){var e=$(ev.target),p=e.parent();if(!p||(!p.hasClass('autocomplete')&&!e.hasClass('ab'))){me.hide();}});},disable:function(){this.disabled=true;},enable:function(){this.disabled=false;},fixOffset:function(){var offset=this.el.offset();this.container.css({top:(offset.top+25),left:offset.left+6});},onKeyPress:function(e){if(this.disabled||!this.enabled){return;}switch(e.keyCode){case 27:this.el.val(this.currentValue);this.hide();break;case 9:case 13:if(this.selectedIndex===-1){this.hide();return;}this.select(this.selectedIndex);if(e.keyCode===9){return;}break;case 38:this.moveUp();break;case 40:this.moveDown();break;default:return;}e.preventDefault();},onKeyUp:function(e){if(this.disabled){return;}switch(e.keyCode){case 38:case 40:return;}if(this.currentValue!==this.el.val()){this.onValueChange();}},onValueChange:function(){this.currentValue=this.el.val();var q=this.getQuery(this.currentValue);this.selectedIndex=-1;if(q.length<this.options.minChars){this.hide();}else{this.getSuggestions(q);}},getQuery:function(val){var d,arr;d=this.options.delimiter;if(!d){return $.trim(val);}
arr=val.split(d);return $.trim(arr[arr.length-1]);},getSuggestions:function(q){var me=this;var pms=me.options.onParams();pms.term=q;$.get(this.source,pms,function(data){me.processData(data);},'json');},hide:function(){this.enabled=false;this.selectedIndex=-1;this.container.hide();},suggest:function(){if(this.suggestions.length===0){this.hide();return;}
var me,len,div,f,v,i,s,mOver,mClick;me=this;len=this.suggestions.length;f=this.options.fnFormatResult;v=this.getQuery(this.currentValue);mOver=function(xi){return function(){me.activate(xi);};};mClick=function(xi){return function(){me.select(xi);};};this.container.hide().empty();for(i=0;i<len;i++){s=this.suggestions[i];div=$((me.selectedIndex===i?'<div class="selected"':'<div')+' title="'+s.label+'">'+f(s.label,s.value,v)+'</div>');div.mouseover(mOver(i));div.click(mClick(i));this.container.append(div);}
this.enabled=true;this.container.show();},processData:function(data){this.suggestions=data;this.suggest();},activate:function(index){var divs,activeItem;divs=this.container.children();if(this.selectedIndex!==-1&&divs.length>this.selectedIndex){$(divs.get(this.selectedIndex)).removeClass();}
this.selectedIndex=index;if(this.selectedIndex!==-1&&divs.length>this.selectedIndex){activeItem=divs.get(this.selectedIndex);$(activeItem).addClass('selected');}
return activeItem;},deactivate:function(div,index){div.className='';if(this.selectedIndex===index){this.selectedIndex=-1;}},select:function(i){var v=this.suggestions[i];if(v){this.el.val(v.label);this.hide();this.onSelect(i);}},moveUp:function(){if(this.selectedIndex===-1){return;}
if(this.selectedIndex===0){this.container.children().get(0).className='';this.selectedIndex=-1;this.el.val(this.currentValue);return;}
this.adjustScroll(this.selectedIndex-1);},moveDown:function(){if(this.selectedIndex===(this.suggestions.length-1)){return;}this.adjustScroll(this.selectedIndex+1);},adjustScroll:function(i){var activeItem,offsetTop,upperBound,lowerBound;activeItem=this.activate(i);offsetTop=activeItem.offsetTop;upperBound=this.container.scrollTop();lowerBound=upperBound+this.options.maxHeight-25;if(offsetTop<upperBound){this.container.scrollTop(offsetTop);}else if(offsetTop>lowerBound){this.container.scrollTop(offsetTop-this.options.maxHeight+25);}this.el.val(this.getValue(this.suggestions[i]));},onSelect:function(i){var me=this,fn,s,d;fn=me.options.onSelect;s=me.suggestions[i].label;d=me.suggestions[i].value;me.el.val(me.getValue(s));if($.isFunction(fn)){fn(s,d,me.el);}},getValue:function(value){var del,currVal,arr,me=this;del=me.options.delimiter;if(!del){return value;}
currVal=me.currentValue;arr=currVal.split(del);if(arr.length===1){return value;}
return currVal.substr(0,currVal.length-arr[arr.length-1].length)+value;}};}(jQuery));var jyeRegion=new Object();$.fn.region=function(dv,a){var self=$(this),id="r"+self.attr("id");if(typeof(dv)=='undefined'){dv=self.attr("dv")||"";}
self.attr("dv",dv);self.after('<input type="hidden" id="'+id+'" name="'+id+'" value="'+dv+'" />');self.focus(function(){var me=$(this);jyeRegion.showAreaPlace(me);}).blur(function(){var me=$(this);if($.trim(me.val())==""){me.next("input").val("");}});jyeRegion.init();jyeRegion.levelEvent=a;$(document).mousedown(function(event){var el=$(event.target),dl=el.closest('dl');if(dl.size()==0||!dl.hasClass('city')){jyeRegion.hiddenAreaPlace();}});return jyeRegion;};jyeRegion={levelEvent:null,init:function(){if($("#areaHolder").size()==0){var rh='<dl id="areaHolder" class="city">'+'<dd>'+'<ul id="area_province"></ul>'+'<ul id="area_city" style="display:none"></ul>'+'<ul id="area_county" style="display:none"></ul>'+'</dd>'+'<dd><span class="fleft" style="color:Blue;">提示：双击直接选该区域</span><input type="button" value="关 闭" class="button fright" onclick="jyeRegion.hiddenAreaPlace()" /></dd>'+'</dl>';$(rh).appendTo(document.body);}},showAreaPlace:function(obj){var cp,cc,cx;var self=this;var position=obj.offset();var dv=obj.attr("dv");var ah=$("#areaHolder");var pl=$("#area_province");var cl=$("#area_city");var xl=$("#area_county");var pv=ah.attr("pv");ah.css({display:"block",left:position.left+obj.outerWidth()+2,top:position.top-85}).data("CR",obj);if(dv&&dv.length==7&&dv!=pv){pl.empty();cl.hide().empty();xl.hide().empty();ah.attr("pv",dv);cp=dv.substring(0,3)+"0000";if(dv.substring(3,5)!="00"){cc=dv.substring(0,5)+"00";if(dv.substring(5,7)!="00")
cx=dv;}
else{if(dv.substring(5,7)!="00")
cc=dv;}}
if(pl.find("li").length==0){self.getArea("/api/area1",pl,function(data){cl.show().empty();xl.hide().empty();self.getArea("/api/area2?code="+data.attr("code"),cl,function(data){xl.empty();if(data.attr("code").substring(5)!='00'){self.returnCode(data);if($.isFunction(self.levelEvent))
self.levelEvent(data.html(),data.attr("code"));return;}
xl.show();self.getArea("/api/area3?code="+data.attr("code"),xl,function(data){self.returnCode(data);},function(){if(cx){var xa=$("a[code='"+cx+"']",xl);if(xa.length!=0)
xa.addClass("thiscity");}});},function(){if(cc){var ca=$("a[code='"+cc+"']",cl);if(ca.length==0)
return;if(cx)
ca.click();else
ca.addClass("thiscity");}});},function(){if(cp){var pa=$("a[code='"+cp+"']",pl);if(pa.length==0)
return;if(cc)
pa.click();else
pa.addClass("thiscity");}});}},getArea:function(url,hd,clickCall,succCall){var self=this;$.post(url,function(data){if(data.S!=0){showMessage(data.M,false);return;}
var al=data.D;var ah=$("#areaHolder");if(al.length==0&&url.indexOf("?")!=-1){var a=$("a[code="+url.toString().split("?")[1].split("=")[1]+"]");if(a.length>0){self.returnCode(a);}}
for(var i=0;i<al.length;++i){var li=$("<li>");var a=$('<a href="javascript:void(0)" />');a.html(al[i].SName);a.attr("code",al[i].ID);a.attr("ct",al[i].Type);a.dblclick(function(){var a=$(this);self.returnCode(a);});a.click(function(){hd.find("li>a").removeClass("thiscity");$(this).addClass("thiscity");if($.isFunction(clickCall))
clickCall($(this));if($.isFunction(self.levelEvent))
self.levelEvent(a.html(),a.attr("code"));});li.append(a).append("<span></span>");hd.append(li);}
if($.isFunction(succCall))
succCall($(this));});},returnCode:function(a){var ah=$("#areaHolder"),cr=ah.data("CR");cr.val(a.html()).attr("dv",a.attr("code")).trigger('change').next("input").val(a.attr("code"));if(a.data("ct")!="0"){var cname=[];$(".thiscity",a.closest("#areaHolder")).each(function(){cname.push($(this).html());});cr.val(cname.join(""));}
ah.attr("pv",a.attr("code"));this.hiddenAreaPlace();},hiddenAreaPlace:function(){$("#areaHolder").css("display","none");}};function initTraining(subject){$("a[ok!='1'].JYE_CLASS_TRAINING").each(function(i,a){a=$(a);if(!jyeoo.isLogin()){a.html("体验训练");}
a.prop("ok","1").attr("onclick","").click(function(){closeBox();Test2.testDoing(this,subject,$(this).attr("pk"),3);return false;});});}
function _openLoginUI(subject,u,o,t){var pu=typeof(u)!='undefined'?encodeURIComponent(u):'',pt=typeof(t)!='undefined'?encodeURIComponent(t):'';var url="/"+subject+"/api/iframelogin?t="+pt+'&u='+pu+"&r="+Math.random();var options={width:434,height:373,title:"【用户登录】"};delLoginCookie();if(typeof(u)!='undefined'&&u!=null){$.cookie('JYE_LB_URL',u);}
if(typeof(o)!='undefined'&&o!=null){$.cookie('JYE_LB_OPTIONS',JSON.stringify(o));}
openBox(options,url);}
function delLoginCookie(){$.removeCookie('JYE_LB_URL');$.removeCookie('JYE_LB_OPTIONS');}
function _openAnalyze(subject,wfid,t){var url="/"+subject+"/report/analyze/"+wfid+"?r="+Math.random();var options={width:900,height:460,title:t};openBox(options,url);}
function loginSuccess(id){showMessage("恭喜您登录成功，系统正在处理相应请求或跳转.");jyeoo.user.ID=id;var ru=$("#ReturnUrl");var u0=ru.size()==1&&ru.val().length>0?ru.val():"";var u1=$.cookie('JYE_LB_URL');var o0=$.cookie('JYE_LB_OPTIONS');delLoginCookie();closeBox();if(u0!=""){window.location.href=decodeURIComponent(u0);}else if(u1!=null&&o0!=null){u1=decodeURIComponent(u1);o0=JSON.parse(decodeURIComponent(o0));openBox(o0,u1);}else if(u1!=null){u1=decodeURIComponent(u1);window.location.href=u1;}else if(typeof(loginCallback)!='undefined'){loginCallback();}else if(window.location.href==wwwRootUrl){window.location.href=spaceRootUrl;}else{window.location.href=window.location.href;}}
function setHomePage(url){try{document.body.style.behavior='url(#default#homepage)';document.body.setHomePage(url);}
catch(e){alert("设置失败，请您手工设置！");}}
function hideIFrameLoading(){$(".JYE_CLASS_LOADING").loaded().hide();}
function text2MathML(text){return jyeditor.prototype.tex2MathML(text);}
function mathML2Text(text){return jyeditor.prototype.mathML2tex(text);}
function editTitle(el,t){el=$(el);var en=el.next(".ets");el.hide();en.show();if(t=="s"){en.find(":text").val(el.html()).focus();}else{en.find("textarea").val(el.html()).focus();}}
function saveTitle(el,t){el=$(el);var pt=el.parent();var en=pt.prev(".ets");if(t=="s"){$.post('/profile/changetitle',{"a":el.val()},function(data){pt.hide();en.html(data.M).show();});}else{$.post('/profile/changesubtitle',{"a":el.val()},function(data){pt.hide();en.html(data.M).show();});}}
function get_selection(){if(window.getSelection)return window.getSelection();else return document.selection;}
function get_selection_range(){var rng=null;var sel=get_selection();if(sel.getRangeAt){rng=sel.getRangeAt(0);if($.browser.opera){var s=rng.startContainer;if(s.nodeType===Node.TEXT_NODE)rng.setStartBefore(s.parentNode);}}else{rng=sel.createRange();rng.select();}
return rng;}
function insertHtml(el,html){var rng=get_selection_range();var sel=get_selection();if(!rng)return;if(window.getSelection){rng.deleteContents();rng.insertNode(get_selection_range().createContextualFragment(html));}else{if(rng.item){rng.execCommand('Delete',false,null);rng=get_selection_range();}
rng.pasteHTML(html);}}
function spinnerMsg(){document.title=g_switch%2?'【　　　】-'+g_title:'【新消息】-'+g_title;var divMessageTitle=$('#divMessageTitle');if(divMessageTitle.size()>0){var color=g_switch%2?'white':'black';divMessageTitle.html('【<span style="color:'+color+'">'+divMessageTitle.attr('title')+'</span>】');}
g_switch++;}
function showSpinner(){stopSpinner();g_spinnerid=window.setInterval(spinnerMsg,1000);}
function stopSpinner(){if(g_spinnerid){window.clearInterval(g_spinnerid);g_spinnerid=null;g_switch=0;document.title=g_title;var divMessageTitle=$('#divMessageTitle');if(divMessageTitle.size()>0){divMessageTitle.html('【'+divMessageTitle.attr('title')+'】');}}}
function _checkMessage(){var div=$('#divMsg'),url='/api/checkmessage?r='+Math.random();g_checkmessageDoing=true;$.post(url,function(data){g_checkmessageDoing=false;g_checkmessageInterval=parseInt(data.D,10);if(data.M.length>0){div.css({'display':'block','position':'fixed','bottom':4,'right':20}).html(data.M).show('slow');var b=$("span.buttons",div);if(b.size()==1){b.remove();$(b.html()).appendTo($("span.comment_button",div));}
showSpinner();}else{div.hide('slow');starCheckMessage();}});}
function starCheckMessage(){if(!g_checkmessageDoing&&jyeoo.isLogin()&&jyeoo.isPopup()){$('#divMsg').hide('slow');window.setTimeout(_checkMessage,g_checkmessageInterval);}}
function loadPage(url){window.location.href=url;}
function loadMenuTab(i,callback){var limenus=$(".JYE_TOP_MENU_TAB_LI").removeClass("onact");if(typeof(i)=="undefined"){g_tab=0;}else if(typeof(i)=="object"){g_tab=limenus.index($(i)[0]);}else{g_tab=parseInt(i,10);}
var el=limenus.eq(g_tab).addClass("onact");var cn=el.attr("cn");if(typeof(cn)!="undefined"){$.cookie(cn,g_tab);}
loadRContent(el.attr("u"),$.isFunction(callback)?callback:null);}
function loadRContent(url,callback){$("#divRContent").empty();var div=$("<div></div>").attr("id","divContentHolder").appendTo($("#divRContent"));div.empty().loading().load(getUrlRandom(url),function(){div.loaded();if($.isFunction(callback)){callback(div);}});}
function loadMenuSub(i,callback){var amenus=$(".JYE_TOP_MENU_SUB_A").removeClass("onthis");if(typeof(i)=="undefined"){g_sub=0;}else if(typeof(i)=="object"){g_sub=amenus.index($(i)[0]);}else{g_sub=parseInt(i,10);}
var el=amenus.eq(g_sub).addClass("onthis");var url=el.attr("href");$("#ddHolder").empty().loading().load(getUrlRandom(url),function(){var div=$(this).loaded();if($.isFunction(callback)){callback(div);}});}
function loadMenuSubB(i,callback){var amenus=$(".JYE_TOP_MENU_SUB_B",$('#dtHolderB')).removeClass("onthis");if(typeof(i)=="undefined"){i=0;}else if(typeof(i)=="object"){i=amenus.index($(i)[0]);}else{i=parseInt(i,10);}
var el=amenus.eq(i).addClass("onthis");var url=el.attr("href");$("#ddHolderB").empty().loading().load(getUrlRandom(url),function(){var div=$(this).loaded();if($.isFunction(callback)){callback(div);}});}
function getUrlRandom(url){if(url.indexOf("R")==-1){if(url.indexOf("?")==-1){url+="?r="+Math.random();}else{url+="&r="+Math.random();}}
return url;}
function openPointCard(subject,no){var url='/'+subject+'/api/pointcard?a='+encodeURIComponent(no)+'&r='+Math.random();var options={width:900,height:460,title:'【考点卡片】',buttons:{"关闭":function(){closeBox(this);}}};if(!jyeoo.isLogin()){openLoginUI(url,options);return;}
openBox(options,url,null,function(){renderLatex($('div.point-card')[0]);$('.JYE_MATH_SELECTOR').jaccordion();});}
function openTopicCard(subject,no){var url='/'+subject+'/api/topiccard?a='+encodeURIComponent(no)+'&r='+Math.random();var options={width:900,height:460,title:'【专题卡片】',buttons:{"关闭":function(){closeBox(this);}}};if(!jyeoo.isLogin()){openLoginUI(url,options);return;}
openBox(options,url,null,function(){renderLatex($('div.topic-card')[0]);$('.JYE_MATH_SELECTOR').jaccordion();});}
function getParentFieldset(el){return $(el).closest("fieldset");}
$.fn.extend({jaccordion:function(b,c){return this.each(function(){$(this).children("h3").each(function(){var arrow=$('<span class="ui-icon ui-icon-circlesmall-minus fright" style="cursor:pointer"></span>');var h3=$(this);h3.prepend(arrow);if(typeof(b)!=="undefined"&&!b){arrow.removeClass("ui-icon-circlesmall-minus");arrow.addClass("ui-icon-circlesmall-plus");h3.next("div").toggle();}
arrow.click(function(){var el=$(this);if(el.hasClass("ui-icon-circlesmall-minus")){el.removeClass("ui-icon-circlesmall-minus");el.addClass("ui-icon-circlesmall-plus");}else{el.removeClass("ui-icon-circlesmall-plus");el.addClass("ui-icon-circlesmall-minus");}
h3.next("div").toggle();if(typeof(c)!=="undefined"){c(el);}});});});},loading:function(p){return this.each(function(){var el=$(this);var position={"z-index":"6000","position":"absolute","width":"16px","height":"16px"};$.extend(position,el.offset());p=typeof(p)!=="undefined"?p:"LT";switch(p){case"LT":position.top+=4;position.left+=4;break;case"CT":position.top+=4;position.left+=(el.width()-16)/2;break;case"RT":position.top+=4;position.left+=el.width()-16-4;break;case"LC":position.top+=(el.height()-16)/2;position.left+=4;break;case"CC":position.top+=(el.height()-16)/2;position.left+=(el.width()-16)/2;break;case"RC":position.top+=(el.height()-16)/2;position.left+=el.width()-16-4;break;case"LB":position.top+=el.height()-16-4;position.left+=4;break;case"CB":position.top+=el.height()-16-4;position.left+=(el.width()-16)/2;break;case"RB":position.top+=el.height()-16-4;position.left+=el.width()-16-4;break;}
var ld=$("#"+el.attr("id")+"_loading");if(ld.size()==0){ld=$("<div>&nbsp;</div>").attr("id",el.attr("id")+"_loading").addClass("loading").appendTo(document.body);}
ld.css(position);});},loaded:function(){return this.each(function(){var el=$(this);$("#"+el.attr("id")+"_loading").remove();});}});function goClass(id){loadPage("http://"+window.location.host+"/class/detail/"+id);}
function showClassBoard(el,id,aid){el=$(el).hide();var url=window.location.href;var bbb=el.closest("div").hasClass("comment_single");if(url.indexOf(id)==-1||bbb){loadPage("http://"+window.location.host+"/class/detail/"+id+"?f="+aid);}else{$("#"+aid).show();}}
function openTestBox(o,c){var t0=o.title||"&nbsp;";var t1=o.title1;var b=openBox(o);b.setTitle(t0+(t1&&t1.length>0?" - "+t1:""));if(typeof(o.url)=='string'){b.getContent().empty().loading().load(o.url,function(){$(this).loaded();if(typeof(c)=='function'){c();}});}else{b.getContent().empty().html(c);}
return b;}
function setTestBoxTitles(el){var b=Box.get(el);if(b){var ct=b.getContent(),e0=$("#spanTitle0",ct),e1=$("#spanTitle1",ct),e2=$("#spanTitle2",ct);var t0=e0.size()==1?e0.html():"",t1=e1.size()==1?e1.html():"",t2=e2.size()==1?e2.html():"";b.setTitle(t0+(t2.length>0?" - "+t2:"")+(t1.length>0?" - "+t1:""));}}
function setTestBoxButtons(el,html){var b=Box.get(el);if(b){if(typeof(html)=='undefined'){html=$('#spanButton',b.getContent()).html();}
b.getFooterBar().css("display","block");b.getButtonsSpan().html(html);b.center();}}
function setTestBoxHtml(el,html,f){var b=Box.get(el);if(b){if(typeof(f)=='undefined'){f=0;}
b.getButtonsSpan(f).html(html);}}
function _getResultObject(){return eval('('+$('#RO').val()+')')}
function checkResultObject(successCallback,errorCallback){var ro=_getResultObject();showResultObject(ro,successCallback,errorCallback);}
function showResultObject(ro,successCallback,errorCallback){showMessage(ro.M,ro.S===0);if(ro.S==0){if($.isFunction(successCallback)){successCallback();}}else{if($.isFunction(errorCallback)){errorCallback();}}}
function postBegin(){}
function postComplete(){}
function postError(){alert('系统提交数据时，发生错误了！请稍候再试...');}
function showMessage(caption,b){var html='';var title='';b=typeof(b)==='undefined'?true:b;if(typeof(caption)=='string'){html=caption;}else{html=caption.M;title=caption.D;}
if(html.length>0){hideMessage();var msgBar=$('<div onclick="hideMessage()"></div>').attr('id','_messsage').addClass('message').addClass(b?'smsg':'emsg').appendTo(document.body);msgBar.html(html).attr('title',title).slideDown('slow');g_msgtimeout=window.setTimeout(hideMessage,5000);}}
function hideMessage(){$("#_messsage").slideUp('slow').remove();if(g_msgtimeout!=null){window.clearTimeout(g_msgtimeout);g_msgtimeout=null;}}
function showProcess(msg){hideProcess();var bar=$('<div onclick="hideProcess()"></div>').attr('id','_process').addClass('message omsg').appendTo(document.body);bar.html(msg).slideDown('slow');}
function hideProcess(){$("#_process").remove();}
String.format=function(str,args){var arg=arguments;if(arg.length==0)
return null;str=String(arg[0]);if(arg.length==1)
return str;for(var i=1;i<arg.length;i++){var re=new RegExp('\\{'+(i-1)+'\\}','gm');str=str.replace(re,arg[i]);}
return str;}
String.getLength=function(str){var arr=str.match(/[^\x00-\xff]/ig);return str.length+(arr==null?0:arr.length);}
String.isNullOrEmpty=function(str){if(typeof str!="string"||str=="")
return true;return false;}
String.prototype.getLength=function(){var arr=this.match(/[^\x00-\xff]/ig);return this.length+(arr==null?0:arr.length);}
String.prototype.format=function(){var args=arguments;return this.replace(/\{(\d+)\}/g,function(match,index){return args[index];});}
String.prototype.trimStart=function(string){if(!string){string="\\s+";}
var trimStartPattern=new RegExp("^("+string+")+","g");return this.replace(trimStartPattern,"");}
String.prototype.trimEnd=function(string){if(!string){string="\\s+";}
var trimEndPattern=new RegExp("("+string+")+$","g");return this.replace(trimEndPattern,"");}
String.prototype.trim=function(string){return this.trimStart(string).trimEnd(string);}
String.prototype.startsWith=function(string){if(!string){string="\\s";}
var startsWithPattern=new RegExp("^("+string+")","g");return startsWithPattern.test(this);}
String.prototype.endsWith=function(string){if(!string){string="\\s";}
var endsWithPattern=new RegExp("("+string+")$","g");return endsWithPattern.test(this);}
String.prototype.left=function(num,mode){if(!/\d+/.test(num))return(this);var str=this.substr(0,num);if(!mode)return str;var n=str.getLength()-str.length;num=num-parseInt(n/2,10);return this.substr(0,num);}
function isGuid(str){if(!str||typeof(str)!="string"||str.length<32)return false;var r=new RegExp(/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/);return r.test(str);}
function getAstro(m,d){m=parseInt(m,10)
d=parseInt(d,10);if((m==12&&d>=22)||(m==1&&d<=20)){return"魔羯座";}
else if((m==1&&d>=21)||(m==2&&d<=19)){return"水瓶座";}
else if((m==2&&d>=20)||(m==3&&d<=20)){return"双鱼座";}
else if((m==3&&d>=21)||(m==4&&d<=20)){return"白羊座";}
else if((m==4&&d>=21)||(m==5&&d<=21)){return"金牛座";}
else if((m==5&&d>=22)||(m==6&&d<=21)){return"双子座";}
else if((m==6&&d>=22)||(m==7&&d<=22)){return"巨蟹座";}
else if((m==7&&d>=23)||(m==8&&d<=23)){return"狮子座";}
else if((m==8&&d>=24)||(m==9&&d<=23)){return"处女座";}
else if((m==9&&d>=24)||(m==10&&d<=23)){return"天秤座";}
else if((m==10&&d>=24)||(m==11&&d<=22)){return"天蝎座";}
else if((m==11&&d>=23)||(m==12&&d<=21)){return"射手座";}
return"";}
(function($){jQuery.fn.friend=function(config){config=$.extend({w1:540,w2:550,sa:'',sb:'',sc:0,sg:0,st:1,se:1,initGroup:null,ok:function(){},cn:function(){}},config);return this.each(function(){var self=$(this);var div=$('<div style="padding:0;margin:2px 0;border:1px solid #ccc;min-height:25px;overflow:visible;cursor:pointer" title="点击搜索"></div>').attr('id',self.attr('id')+'_divSelectResult').insertAfter(self);var img=$('<img style="float: right; cursor: pointer" src="'+imageRootUrl+'images/search.gif" alt="搜索" />').appendTo(div);var ol=$('<ol style="overflow: hidden"></ol>').attr('id',self.attr('id')+'_olSelectResult').appendTo(div);var div1=$('<div style="display:none;border:1px solid #BBE1F1;background:#EEFAFF;padding:10px 20px;position:absolute"></div>').attr('id',self.attr('id')+'_divSelectUserUI').insertAfter(self);var div2=$('<div></div>').attr('id',self.attr('id')+'_divUsers').appendTo(div1);if(config.sg==0){$('<a href="javascript:void(0)" onclick="_checkAll()" class="fright">全选</a>').appendTo(div1);}
var btn0=$('<input type="button" class="button" value="确定" />').appendTo(div1);var btn1=$('<input type="button" class="button" value="取消" />').appendTo(div1);div.width(config.w1);div1.width(config.w2);div.click(function(){searchClick(self);});btn0.click(function(){okClick(self,config.ok);});btn1.click(function(){cnClick(self,config.cn);});$(document).mousedown(function(event){var $target=$(event.target);if($('#'+self.attr('id')+'_divSelectUserUI').size()>0&&($target.closest('#'+self.attr('id')+'_divSelectUserUI').length==0)){cnClick(self,config.cn);}});if(self.val().length>0){$.post("/api/searchinit",{"a":self.val(),"r":Math.random()},function(data){createLis(self,data);setUsers(self);});}});function searchClick(element){var mid=$(element).attr('id');var offset=$('#'+mid+'_divSelectResult').position();$('#'+mid+'_divUsers').load("/friend/search?a="+config.sa+"&b="+config.sb+"&c="+config.sc+"&g="+config.sg+"&e="+config.se+"&t="+config.st+"&r="+Math.random(),function(){$('#'+mid+'_divSelectUserUI').css({'left':offset.left,'top':offset.top}).show();if(config.initGroup!=null){$('#My_Group').val(config.initGroup).trigger("change");}});};function okClick(element,ok){var mid=$(element).attr('id');var a=$('.JYE_CLASS_CHK:checked');if(a.size()>0){var ids=[];a.each(function(){var el=$(this);var da={"UserID":el.val(),"Html":el.next("span").html()};ids.push(da);});if(config.sg==1){$('#'+mid+'_olSelectResult').empty();}
createLis(element,ids);setUsers(element);}
$('#'+mid+'_divUsers').empty();$('#'+mid+'_divSelectUserUI').hide();ok();};function cnClick(element,cn){var mid=$(element).attr('id');$('#'+mid+'_divUsers').empty();$('#'+mid+'_divSelectUserUI').hide();cn();};function createLis(element,ids){var mid=$(element).attr('id');var ol=$('#'+mid+'_olSelectResult');for(var i=0;i<ids.length;i++){var obj=ids[i];var li=$('li[ud='+obj.UserID+']',ol);if(li.size()==0){li=$('<li style="display:block;float:left;margin:2px;padding:0 2px;word-break:keep-all;width:23%" class="even"></li>').attr('ud',obj.UserID).html(obj.Html).appendTo(ol);$('<img src="'+imageRootUrl+'images/del1.gif" style="margin:4px;float:right" alt="移出" />').click(function(){$(this).parent().remove();setUsers(element);}).prependTo(li);}}};function setUsers(element){var mid=$(element).attr('id');var users='';var ol=$('#'+mid+'_olSelectResult');ol.children('li').each(function(i){if(i===0){users=$(this).attr('ud');}else{users+=','+$(this).attr('ud');}});$('#'+mid).val(users);};};})(jQuery);function deleteGiftBox(id){if(window.confirm('您确定要删除这件礼物吗？')){$.post('/gift/giftboxdelete',{"a":id,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}},null);});}}
function sendGift(userID){loadPage('/gift/index?t=0&a='+userID+"&r="+Math.random());}
function deleteFriend(userID){if(window.confirm('是否确定断开您和该好友的关系？')){$.post('/api/deletefriend',{"a":userID,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}},null);});}}
function addToFriend(userId){var url='/friend/friendadd?a='+encodeURIComponent(userId)+"&r="+Math.random();var options={width:800,height:400,title:"【加为好友】"};openBox(options,url,null,null);}
function deleteMessage(msgID){starCheckMessage();$.post('/api/deletemessage',{"a":msgID,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}},null);});}
function sendMessage(userID){if(typeof(userID)=="undefined")userID="";starCheckMessage();var url='/api/sendmessage?a='+userID+"&r="+Math.random();var options={width:800,height:400,title:"【发送消息】",buttons:{"发送":function(){sendMessagePost();},"取消":function(){closeBox(this);}}};openBox(options,url,null,function(box){$('#Send_Users',box.getContent()).friend({sc:1});$('#Send_Message',box.getContent()).focus();});}
function sendMessagePost(){starCheckMessage();var b=Box.get(),p={'a':'','b':'','c':'','r':Math.random()};if(b){p.a=$("#Send_Users",b.getContent()).val();p.b=$("#Send_Message",b.getContent()).val();p.c=$("#Send_User_Type",b.getContent()).val();}else{p.a=$("#Send_Users").val();p.b=$("#Send_Message").val();p.c=$("#Send_User_Type").val();}
$.post("/api/sendmessagepost",p,function(data){if(data.S==0){showMessage(data.M,true);closeBox();}else{showMessage(data.M,false);}});}
function replyMessage(msgID){starCheckMessage();var url='/api/replymessage?a='+encodeURIComponent(msgID);var options={width:800,height:400,title:"【回复消息】"};openBox(options,url,null,function(box){$('#Send_Message',box.getContent()).focus();});}
function replyMessagePost(){var b=Box.get(),p={"a":"","b":"","r":Math.random()};if(b){p.a=$("#Send_ID",b.getContent()).val();p.b=$("#Send_Message",b.getContent()).val();}else{p.a=$("#Send_ID").val();p.b=$("#Send_Message").val();}
$.post("/api/replymessagepost",p,function(data){if(data.S==0){showMessage(data.M,true);closeBox();}else{showMessage(data.M,false);}});}
function agreeApply(ID){starCheckMessage();$.post('/api/applyfriend',{"a":1,"b":ID,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}},null);});}
function opposeApply(ID){starCheckMessage();$.post('/api/applyfriend',{"a":0,"b":ID,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}},null);});}
function addFriends(emails){starCheckMessage();$.post('/friend/friendadd2',{"a":emails,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}},null);});}
function setFriendGroup(ID){starCheckMessage();var url='/api/friendgroup?a='+ID+"&r="+Math.random();var options={width:800,height:400,title:"【设置分组】",buttons:{"确定":function(){setFriendGroupPost();},"取消":function(){closeBox(this);}}};openBox(options,url,null,null);}
function setFriendGroupPost(){var b=Box.get(),p={"a":"","b":"","r":Math.random()};if(b){p.a=$("#FG_UserID",b.getContent()).val();$("input[type=checkbox][name=FG_SLTED]:checked",b.getContent()).each(function(){p.b+=$(this).val()+",";});}else{p.a=$("#FG_UserID").val();$("input[type=checkbox][name=FG_SLTED]:checked").each(function(){p.b+=$(this).val()+",";});}
$.post('/api/friendgrouppost',p,function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}closeBox();},null);});}
function editFriendGroup(xx){var eOptions={width:400,height:120,title:"【分组管理】",buttons:{"保存":function(){saveFriendGroup();},"关闭":function(){closeBox(this);}}};xx=typeof(xx)=='string'?xx:$(xx).attr('pk');openBox(eOptions,'/api/editfriendgroup?a='+encodeURIComponent(xx)+"&r="+Math.random());}
function saveFriendGroup(){var b=Box.get(),p={"a":"","b":"","r":Math.random()};if(b){p.a=$("#GP_ID",b.getContent()).val();p.b=$("#GP_Name",b.getContent()).val();}else{p.a=$("#GP_ID").val();p.b=$("#GP_Name").val();}
$.post('/api/savefriendgroup',p,function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}closeBox();});});}
function newFriendGroup(){var b=Box.get(),ol,ad;if(b){ol=$('.OL_FORSELECTED',b.getContent());ad=$('#AddSLTED',b.getContent());}else{ol=$('.OL_FORSELECTED');ad=$('#AddSLTED');}
if(ad.size()>0){ad.focus();}else{var li=$('<li style="width:32%;float:left"></li>').appendTo(ol),lb=$('<label></label>').appendTo(li),ck=$('<input type="checkbox" class="checkbox" />').attr('name','FG_SLTED').attr('id','FG_SLTED').appendTo(lb);ad=$('<input type="text" size="10" maxlength="10" />').attr('id','tbSLTED').appendTo(lb);ad.blur(function(){newFriendGroupBlur($(this),li,lb,ck);});ad.focus();}}
function newFriendGroupBlur(el,li,lb,ck){var txt=$.trim(el.val());if(txt.length>0){$.post("/api/savefriendgroup",{"a":g_emptyguid,"b":txt,"r":Math.random()},function(d){if(d.S==0){ck.attr('value',d.D);el.remove();$('<span></span>').html(txt).appendTo(lb);}else{li.remove();}});}else{li.remove();}}
function deleteFriendGroup(xx){xx=typeof(xx)=='string'?xx:$(xx).attr('pk');if(confirm('您是否要删除好友分组？\r\n提示：该操作不会删除分组下面的好友')){$.post('/api/deletefriendgroup',{"a":xx,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}});});}}
function saveSuccess(){starCheckMessage();checkResultObject(function(){if(typeof(refreshMe)!='undefined'){refreshMe();}closeBox();},null);}
function send1Success(){starCheckMessage();checkResultObject(function(){if(typeof(refreshMe)!='undefined'){refreshMe();}closeBox();},function(){initSend1();});}
function selectFriends(){var url='/friend/search?a=&b=&c=1&d=0&e=1&r='+Math.random();var options={width:800,height:400,title:"【选择好友】",buttons:{"确定":function(){$('#btnOk').click();},"取消":function(){closeBox(this);}}};openBox(options,url,null,null);}
(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else if(typeof exports==='object'){factory(require('jquery'));}else{factory(jQuery);}}(function($){var pluses=/\+/g;function encode(s){return config.raw?s:encodeURIComponent(s);}
function decode(s){return config.raw?s:decodeURIComponent(s);}
function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value));}
function parseCookieValue(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}
try{s=decodeURIComponent(s.replace(pluses,' '));return config.json?JSON.parse(s):s;}catch(e){}}
function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value;}
var config=$.cookie=function(key,value,options){if(value!==undefined&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setTime(+t+days*864e+5);}
return(document.cookie=[encode(key),'=',stringifyCookieValue(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}
var result=key?undefined:{};var cookies=document.cookie?document.cookie.split('; '):[];for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=parts.join('=');if(key&&key===name){result=read(cookie,value);break;}
if(!key&&(cookie=read(cookie))!==undefined){result[name]=cookie;}}
return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)===undefined){return false;}
$.cookie(key,'',$.extend({},options,{expires:-1}));return!$.cookie(key);};}));function logoutConfirm(url){if(window.confirm('是否真的想退出菁优网？')){window.location.href=url;}}
function initRowtable(o,d){$('.rowtable tr[ad!=1]').unbind('hover').unbind("click").hover(function(){$(this).addClass('hover');},function(){$(this).removeClass('hover');}).click(function(event){var target=$(event.target),td0=$("td:last",$(this)),td1=target.closest('td');if(td1.size()==0||(td0.html()!=td1.html()&&!td1.hasClass("action"))){var btns=$('input.smbtn[type=button]',td0);if(btns.size()>0){btns.eq(0).trigger('click');}}});$('.rowtable tr[ad!=1]').each(function(){$(this).attr('ad','1');});$('.rowtable tr:odd').addClass('odd');if(typeof(o)!='undefined'&&typeof(d)!='undefined'){$('th[order][ad!=1]').wrapInner('<a href="javascript:void(0)" onclick="headSortClick(this)"></a>');var a=$('th[ad!=1][order='+o+']').find('a');if(a.size()==0){return;}
var b=a.find('input.sort');if(b.size()==0){b=$('<input type="button" class="sort" />');b.appendTo(a);}
b.removeClass('asc');b.removeClass('desc');b.addClass(d==0?'asc':'desc');$('th[order][ad!=1]').each(function(){$(this).attr('ad','1');});}}
function headSortClick(el){el=$(el);var o=el.parent().attr('order'),d=0,b=el.find('input');if(b.size()==0){b=$('<input type="button" class="sort" />');}
if(b.hasClass('asc')){b.removeClass('asc');b.addClass('desc');d=1;}else{b.removeClass('desc');b.addClass('asc');}
$('th[order]',el.closest('tr')).find('input.sort').remove();b.appendTo(el);if(typeof(tableSortCallback)=='function'){tableSortCallback(o,d);}}
function initForm(){$('input[type=text][added!=1]').each(function(){var el=$(this).attr('added',1);var dt=el.attr('dt');var me=el.attr('me');if(me!=undefined){el.css("ime-mode",me);}
if(dt!=undefined){el.datepicker();}});$(":radio").addClass('radio');$(":checkbox").addClass('checkbox');}
(function(a){a.fn.jTooltip=function(f,r){f=a.extend({content:null,ajax:null,follow:true,auto:true,fadeIn:0,fadeOut:0,appendTip:document.body,degrade:false,offsetY:10,offsetX:1,style:{},className:null,id:null,callBefore:function(t,p,o){},callAfter:function(t,p,o){},clickAction:function(p,o){a(p).hide()},delay:0,timeout:0},f||{});if(!f.style&&typeof f.style!="object"){f.style={};f.style.zIndex="6000"}else{f.style=a.extend({zIndex:"6000",textAlign:"left"},f.style||{})}if(typeof r=="function"){f.callAfter=r||f.callAfter}f.style.display="none",f.style.position="absolute";var m,l,q,c,k={},b=true,e=false,n=false,s=document.createElement("div"),g=(typeof document.body.style.maxWidth=="undefined")?true:false,j=false;if(f.id){s.id=f.id}if(f.className){s.className=f.className}f.degrade=(f.degrade&&g)?true:false;for(var d in f.style){s.style[d]=f.style[d]}function i(o){if(o){if(f.degrade){a(s).html(f.content.replace(/<\/?[^>]+>/gi,""))}else{a(s).html(f.content)}}}if(f.ajax){a.get(f.ajax,function(o){if(o){f.content=o}i(f.content)})}function h(p){function t(u){if(m&&!f.content){m=null}}function o(){if(!e&&f.auto){clearInterval(c);if(f.fadeOut){a(s).fadeOut(f.fadeOut,function(){t(p)})}else{t(p);s.style.display="none"}}if(typeof f.callAfter=="function"){f.callAfter(s,p,f)}if(j){f=a.listen(f)}}if(f.timeout>0){q=setTimeout(function(){o()},f.timeout)}else{o()}}a(s).hover(function(){e=true},function(){e=false;h(k)});i(f.content&&!f.ajax);a(s).appendTo(f.appendTip);return this.each(function(){a(this).hover(function(){var p=this;clearTimeout(q);if((this.title||this.titleMemKeep)&&!f.degrade&&!f.content){m=this.title||this.titleMemKeep;if(this.title){this.titleMemKeep=this.title;this.title=null}}if(f.content&&f.degrade){this.title=s.innerHTML}function o(){if(typeof f.callBefore=="function"){f.callBefore(s,p,f)}if(f.auto){var t;if(f.content){if(!f.degrade){t="block"}}else{if(m&&!f.degrade){a(s).html(unescape(m));t="block";m=null}else{t="none"}}if(t=="block"&&f.fadeIn){a(s).fadeIn(f.fadeIn)}else{s.style.display=t}}}if(f.delay>0){l=setTimeout(function(){o()},f.delay)}else{o()}},function(){clearTimeout(l);var o=this;b=true;if(!f.follow||n||(f.offsetX<0&&f.offsetY<0)){setTimeout(function(){c=setInterval(function(){h(o)},1)},1)}else{h(this)}});a(this).mousemove(function(v){k=this;if(f.follow||b){var y=a(window).scrollTop(),z=a(window).scrollLeft(),w=v.clientY+y+f.offsetY,t=v.clientX+z+f.offsetX,x=a(f.appendTip).outerHeight(),p=a(f.appendTip).innerHeight(),o=a(window).width()+z-a(s).outerWidth(),u=a(window).height()+y-a(s).outerHeight();w=(x>p)?w-(x-p):w;n=(w>u||t>o)?true:false;if(t-z<=0&&f.offsetX<0){t=z}else{if(t>o){t=o}}if(w-y<=0&&f.offsetY<0){w=y}else{if(w>u){w=u}}s.style.top=w+"px";s.style.left=t+"px";b=false}});if(typeof f.clickAction=="function"){a(this).click(function(){f.clickAction(s,this)})}})}})(jQuery);jQuery.fn.countup=function(params){var self=this;self.display=$(this);self.begin=new Date(params.begin);self.addZeros=params.addZeros?params.addZeros:false;self.onTick=params.onTick?params.onTick:function(){return true;};self.onFinish=params.onFinish?params.onFinish:function(){return true;};self._tick=function(){var now=(new Date()-self.begin);var seconds=now.valueOf()/1000;var day=(Math.floor(seconds/86400))%86400;var hrs=(Math.floor(seconds/3600))%24;var min=(Math.floor(seconds/60))%60;var sec=(Math.floor(seconds/1))%60;if(!self.onTick(self.display,day,hrs,min,sec)){window.clearInterval(self._interval);if(!self.onFinish(self.display)){return;}
return;};if(self.addZeros){hrs=(hrs+"").length<2?"0"+hrs:hrs;min=(min+"").length<2?"0"+min:min;sec=(sec+"").length<2?"0"+sec:sec;};self.display.html((parseInt(day,10)>0?day+"<span>天</span>":"")+(parseInt(day,10)>0||parseInt(hrs,10)>0?hrs+"<span>时</span>":"")+(parseInt(day,10)>0||parseInt(hrs,10)>0||parseInt(min,10)>0?min+"<span>分</span>":"")+sec+"<span>秒</span>");};self._interval=window.setInterval(self._tick,params.interval?params.interval:1000);self.abort=function(){window.clearInterval(self._interval);};return this;};jQuery.fn.countdown=function(params){var self=this;self.display=$(this);self.end=new Date(params.end);self.message=params.message?params.message:"倒计时完成。";self.addZeros=params.addZeros?params.addZeros:false;self.onTick=params.onTick?params.onTick:function(){return true;};self.onFinish=params.onFinish?params.onFinish:function(){return true;};self._tick=function(){var now=(self.end-new Date());if(now.valueOf()<0){window.clearInterval(self._interval);if(!self.onFinish(self.display)){return;}
self.display.html(self.message);return;};var seconds=now.valueOf()/1000;var day=(Math.floor(seconds/86400))%86400;var hrs=(Math.floor(seconds/3600))%24;var min=(Math.floor(seconds/60))%60;var sec=(Math.floor(seconds/1))%60;if(!self.onTick(self.display,day,hrs,min,sec)){return;};if(self.addZeros){hrs=(hrs+"").length<2?"0"+hrs:hrs;min=(min+"").length<2?"0"+min:min;sec=(sec+"").length<2?"0"+sec:sec;};self.display.html((parseInt(day,10)>0?day+"<span>天</span>":"")+(parseInt(day,10)>0||parseInt(hrs,10)>0?hrs+"<span>时</span>":"")+(parseInt(day,10)>0||parseInt(hrs,10)>0||parseInt(min,10)>0?min+"<span>分</span>":"")+sec+"<span>秒</span>");};self._interval=window.setInterval(self._tick,params.interval?params.interval:1000);self.abort=function(){window.clearInterval(self._interval);};return this;};function Box(options){this.box=$(Box.UI);$.data(this.box[0],'box',this);this.visible=false;this.options=$.extend({},Box.DF,options||{});if(this.options.modal){this.options=$.extend(this.options,{center:true});}
this._setupTitleBar();this.setButtons(this.options.buttons);this.resize(this.options.width,this.options.height);this.box.css('display','none').appendTo(document.body);this.toTop();if(this.options.center&&Box._u(this.options.x,this.options.y)){this.center();}else{this.moveTo(Box._u(this.options.x)?this.options.x:80,Box._u(this.options.y)?this.options.y:80);}
if(this.options.show)this.open();};Box.EF=function(){};$.extend(Box,{UI:"<div class='box-wrapper'><div class='box-inner'><div class='title-bar'><h2></h2></div><div class='body-content'></div><div class='footer-bar'><span class='h1 fright'></span><span class='h0'></span></div></div></div>",DF:{title:"菁优网",buttons:{},closeable:true,draggable:true,center:true,show:true,modal:true,width:300,height:200,open:Box.EF,close:Box.EF},zIndex:1029,dragConfigured:false,resizeConfigured:false,dragging:null,get:function(el){var p=null;if(typeof el!='undefined'){p=$(el).parents('.box-wrapper');}else{var z=0;$('.box-wrapper').each(function(){var t=parseInt($(this).css("zIndex"),10);if(t>z){z=t;p=$(this);}});}
return p!=null&&p.length?$.data(p[0],'box'):null;},_u:function(){for(var i=0;i<arguments.length;i++){if(typeof arguments[i]!='undefined'){return false;}}
return true;},_handleResize:function(evt){var d=$(document);$('.box-overlay').css('display','none').css({width:d.width(),height:d.height()}).css('display','block');},_handleDrag:function(evt){var d;if(d=Box.dragging){d[0].box.css({left:evt.pageX-d[1],top:evt.pageY-d[2]});}},_nextZ:function(){return Box.zIndex++;},_viewport:function(){var d=document.documentElement,b=document.body,w=window;return $.extend($.browser.msie?{left:b.scrollLeft||d.scrollLeft,top:b.scrollTop||d.scrollTop}:{left:w.pageXOffset,top:w.pageYOffset},!Box._u(w.innerWidth)?{width:w.innerWidth,height:w.innerHeight}:(!Box._u(d)&&!Box._u(d.clientWidth)&&d.clientWidth!=0?{width:d.clientWidth,height:d.clientHeight}:{width:b.clientWidth,height:b.clientHeight}));}});Box.prototype={estimateSize:function(){this.box.css({visibility:'hidden',display:'block'});var dims=this.getSize();this.box.css('display','none').css('visibility','visible');return dims;},getSize:function(){return[this.box.width(),this.box.height()];},getContentSize:function(){var c=this.getContent();return[c.width(),c.height()];},getPosition:function(){var b=this.box[0];return[b.offsetLeft,b.offsetTop];},getCenter:function(){var p=this.getPosition();var s=this.getSize();return[Math.floor(p[0]+s[0]/2),Math.floor(p[1]+s[1]/2)];},getInner:function(){return $('.box-inner',this.box);},getTitleBar:function(){return $('> .title-bar',this.getInner());},getContent:function(){return $('> .body-content',this.getInner());},getFooterBar:function(){return $('> .footer-bar',this.getInner());},setContent:function(c){this.getContent().empty().html(c);return this;},moveTo:function(x,y){this.moveToX(x).moveToY(y);return this;},moveToX:function(x){if(typeof x=='number')this.box.css({left:x});else this.centerX();return this;},moveToY:function(y){if(typeof y=='number')this.box.css({top:y});else this.centerY();return this;},centerAt:function(x,y){var s=this[this.visible?'getSize':'estimateSize']();if(typeof x=='number')this.moveToX(x-s[0]/2);if(typeof y=='number')this.moveToY(y-s[1]/2);return this;},center:function(axis){var v=Box._viewport();var o=[v.left,v.top];if(!axis||axis=='x')this.centerAt(o[0]+v.width/2,null);if(!axis||axis=='y')this.centerAt(null,o[1]+v.height/2);return this;},centerX:function(){return this.center('x');},centerY:function(){return this.center('y');},resize:function(w,h,a){var v=Box._viewport();w=Math.min(w,v.width-40);h=Math.min(h,v.height-80);var bounds=this._getBoundsForResize(w,h);this.box.css({left:bounds[0],top:bounds[1]});this.getInner().width(bounds[2]);this.getContent().height(bounds[3]);if(a)a(this);return this;},tween:function(width,height,after){if(!this.visible)return;var self=this,bounds=this._getBoundsForResize(width,height);this.box.stop().animate({left:bounds[0],top:bounds[1]});this.getContent().stop().animate({width:bounds[2],height:bounds[3]},function(){if(after)after(self);});return this;},open:function(){if(this.visible)return;if(this.options.modal){var self=this;if(!Box.resizeConfigured){Box.resizeConfigured=true;$(window).resize(function(){Box._handleResize();});}
this.modalBlackout=$('<div class="box-overlay"></div>').css({zIndex:Box._nextZ(),width:$(document).width(),height:$(document).height()}).appendTo(document.body);this.toTop();if(this.options.closeable){$(document.body).bind('keypress.box',function(evt){var key=evt.which||evt.keyCode;if(key==27){self.close();$(document.body).unbind('keypress.box');}});}}
this.box.stop().css({opacity:1}).show();this.visible=true;this._fire('open');return this;},close:function(after){if(!this.visible)return;var self=this;if(this.options.modal){$(document.body).unbind('keypress.box');this.modalBlackout.remove();}
this.box.stop().css({display:'none'});this.visible=false;if(after)after(self);this.unload();return this;},setOptions:function(options){this.options=$.extend({},this.options,options||{});},unload:function(){this._fire('close');this.box.remove();},toTop:function(){this.box.css({zIndex:Box._nextZ()});return this;},getTitle:function(){return $('> h2',this.getTitleBar()).html();},setTitle:function(t){$('> h2',this.getTitleBar()).html(t);return this;},getButton:function(text){var r=null;this.getButtons().each(function(){var b=$(this);if(b.text()==text){r=b;}});return r;},getButtons:function(){return $(':button',this.getFooterBar());},getButtonsSpan:function(f){if(typeof(f)=="undefined")f=1;return $('span.h'+f,this.getFooterBar());},setButtons:function(buttons,f){this._setupButtons(buttons,f);return this;},_getBoundsForResize:function(width,height){var csize=this.getContentSize(),delta=[width-csize[0],height-csize[1]],p=this.getPosition();return[Math.max(p[0]-delta[0]/2,0),Math.max(p[1]-delta[1]/2,0),width,height];},_setupTitleBar:function(){var self=this;this.setTitle(this.options.title);var tb=$(".title-bar",this.getInner());if(this.options.closeable){$('<input type="button" class="smbtn hclose" title="关闭" />').appendTo(tb).click(function(){self.close();});}
if(this.options.draggable){tb.onselectstart=function(){return false;}
tb.unselectable='on';if(!Box.dragConfigured){$(document).mousemove(Box._handleDrag);Box.dragConfigured=true;}
tb.mousedown(function(evt){self.toTop();Box.dragging=[self,evt.pageX-self.box[0].offsetLeft,evt.pageY-self.box[0].offsetTop];$(this).addClass('dragging');}).mouseup(function(){$(this).removeClass('dragging');Box.dragging=null;});}},_setupButtons:function(buttons,f){var self=this,h=false,bar=this.getFooterBar();if(typeof buttons==='object'&&buttons!==null){$.each(buttons,function(){return!(h=true);});}
if(h){bar.css("display","block");if(typeof(f)=="undefined")f=1;var h0=$('span.h0',bar),h1=$('span.h1',bar);$.each(buttons,function(name,props){props={click:props,text:name};$('<button type="button"></button>').attr(props,true).appendTo(f==0?h0:h1);});}},_fire:function(event){this.options[event].call(this);}};function openBox(o,u,p,c){var d={"width":900,"height":460,"title":"菁优网","buttons":{}};o=$.extend({},d,o||{});var b=new Box(o);var h=b.getContent();if(typeof(u)!='undefined'){if(typeof(p)=='undefined'||p==null||p=={}){h.empty().loading().load(u,function(){h.loaded();if($.isFunction(c)){c(b);}});}else{h.empty().loading().load(u,p,function(){h.loaded();if($.isFunction(c)){c(b);}});}}
return b;}
function setBoxTitle(title,el){var b=Box.get(el);if(b)b.setTitle(title);}
function setBoxContent(content,el){var b=Box.get(el);if(b){b.setContent(content);}}
function getBoxButton(text,el){var b=Box.get(el);if(b){return b.getButton(text);}else{return null;}}
function getBoxButtons(el){var b=Box.get(el);if(b){return b.getButtons();}else{return null;}}
function getBoxButtonsSpan(f,el){var b=Box.get(el);if(b){return b.getButtonsSpan(el,f);}
else{return null;}}
function closeBox(el){var b=Box.get(el);if(b){b.close();}}
function setBoxFooterBar(html,el){var b=Box.get(el);if(b){if(typeof(html)=='undefined'){html=$('#divFooterBar',b.getContent()).html();}
b.getFooterBar().css("display","block").html(html).css({"padding":"0px"});b.center();}}
function getBoxInner(el){var b=Box.get(el);if(b){return b.getInner();}
else{return null;}}
function getBoxContent(el){var b=Box.get(el);if(b){return b.getContent();}
else{return null;}}
function selectThisOption(el,text){var ul=$(el).closest("ul");if(ul.size()==1){var tb=ul.data("tb");if(tb!=undefined&&tb.hasClass("quizPutTag")){tb.text(text).blur();ul.hide();}}}
function openConfirm(title,s,id,dt,hw){if(jyeoo.isLogin()){var dcm=$('div.JYE_DCM'),dm=0,dmkey='dc_'+dt+'_md';if(dcm.size()>0){$('input[name=dm]:checked',dcm).each(function(){var v=parseInt($(this).val(),10);dm=dm|v;});$.cookie(dmkey,dm);closeBox();}else{var vm=$.cookie(dmkey);if(vm!=null&&vm.length>0){dm=vm;}}
var w=640,h=380;if(dt==1||dt==4||dt==7){h=280;}
if(typeof(hw)=="undefined"){hw='';}
var options={'width':w,'height':h,'title':title};openBox(options,'/'+s+'/api/confirm?id='+encodeURIComponent(id)+'&dm='+dm+'&dt='+dt+'&hw='+hw+'&r='+Math.random());}else{openLoginUI(window.location.href);}}
function openSupportPoint(s){var options={width:777,height:450,title:'如何获取优点？'};openBox(options,'/'+s+'/api/howtopoint?r=10',null,function(){});}
function howToVIP(s){var options={width:777,height:450,title:'如何成为菁优网VIP用户？'};openBox(options,'/'+s+'/api/howtovip?r=10',null,function(){});}
function Play(u){try{var slc=document.getElementById('scPlayer');if(slc){if(typeof(u)=="undefined"){slc.Content.Player.Play();}else{slc.Content.Player.Url=u;window.setTimeout(function(){slc.Content.Player.Play();},1000);}}}catch(e){}}
function Pause(){try{var slc=document.getElementById('scPlayer');if(slc){slc.Content.Player.Pause();}}catch(e){}}
var Test2={_holderID:'',_floatID:'ftip',_index:0,_asTimer:null,_upTimer:null,_downTimer:null,init:function(id){Test2._holderID=id;var accordion=Test2._getHolder().jaccordion();$(".JYE_MATH_SELECTOR",accordion).each(function(){try{renderLatex(this);}catch(e){}});try{$('.jye',accordion).jye({controls:["subscript","superscript"]});}catch(e){}
try{renderLatex(accordion[0]);}catch(e){}},_getHolder:function(){var b=Box.get();if(b){return $('#'+Test2._holderID,b.getContent());}else{return $('#'+Test2._holderID);}},initSAnswers:function(){var accordion=Test2._getHolder();$('.sanwser',accordion).each(function(){var el=$(this);var div=el.prev('div');div.jTooltip({content:el.html(),className:'sanwser'});});$("input.s[type='radio'],input.s[type='checkbox']",accordion).each(function(){var el=$(this).prop("checked",false).removeClass("s");el.closest("td").addClass("s");});$("input.r[type='radio'],input.r[type='checkbox']",accordion).each(function(){var el=$(this).prop("checked",true).removeClass("r");el.closest("td").addClass("r");});$("input.m[type='radio'],input.m[type='checkbox']",accordion).each(function(){var el=$(this).prop("checked",true).removeClass("m");el.closest("td").addClass("m");});},scrollTo:function(el){var bc=getBoxContent();if(bc){var div=el.parent();if(div.css('display')=='none'){div.prev('h3').children('span').click();}
bc.scrollTop(bc.scrollTop()+el.position().top);}},initFieldtip:function(){var accordion=Test2._getHolder();$('fieldset',accordion).each(function(){var fld=$(this);fld.hover(function(){fld.addClass('thison');},function(){fld.removeClass('thison');});});Test2.showFieldtip(false);},showFieldtip:function(b){$('fieldset',Test2._getHolder()).each(function(){var fld=$(this);var el=fld.next('span').find("a").eq(0);});},checkInputs:function(){var first=null;Test2._getHolder().children("h3").each(function(i){var h3=$(this);$('fieldset',h3.next('div')).each(function(){var el=$(this);$('.quizPutTag',el).each(function(){var qt=$(this);var html=qt.html();if(html.length>0){qt.removeClass('input-validation-error');}else{qt.addClass('input-validation-error');if(first==null)first=el;}});if($('input:checkbox,input:radio',el).size()>0){if($('input:checked',el).size()>0){el.removeClass('quesbordere');}else{el.addClass('quesbordere');if(first==null)first=el;}}});});return first;},setEvents:function(){Test2._getHolder().children("h3").each(function(i){var h3=$(this);$('fieldset',h3.next('div')).each(function(){var el=$(this);$('.quizPutTag',el).blur(function(){var qt=$(this);var html=qt.html();if(html.length>0){qt.removeClass('input-validation-error');}else{qt.addClass('input-validation-error');}});$('input:checkbox,input:radio',el).click(function(){if($('input:checked',el).size()>0){el.removeClass('quesbordere');}else{el.addClass('quesbordere');}});});});},getAnswers:function(){var answers=[];Test2._getHolder().children("h3").each(function(i){var h3=$(this);var an={Title:h3.attr('title'),Questions:[]};$('fieldset',h3.next('div')).each(function(){var el=$(this);var qs={QuesID:el.attr('id'),Contents:[]};$('.quizPutTag',el).each(function(){var cs={Contents:[],IsTrue:0};var html=$(this).html();html=mathML2Text(html);cs.Contents.push(html);qs.Contents.push(cs);});var mscs={Contents:[],IsTrue:0};$('input:checked',el).each(function(){mscs.Contents.push($(this).val());});if(mscs.Contents.length>0)qs.Contents.push(mscs);an.Questions.push(qs);});answers.push(an);});return answers;},selectSubjectAndBook:function(subject){var url="/"+subject+"/training/selectbook?r="+Math.random();var options={width:900,height:460,title:"设置学科和教材",buttons:{"保存设置":function(){Test2.submitSubjectAndBook(subject);},"取消":function(){closeBox(this);}}};closeBox();openBox(options,url);},submitSubjectAndBook:function(subject){var a=$("input[type=radio]:checked",$('#divSections'));var b=$("input[type=radio]:checked",$('#divSubjects'));var c=$("input[type=radio]:checked",$('#divEditions'));var d=$("input[type=radio]:checked",$('#divBooks'));if(a.size()!=1){showMessage("请选择学段。",false);return;}
if(b.size()!=1){showMessage("请选择学科。",false);return;}
if(c.size()!=1){showMessage("请选择版本。",false);return;}
if(d.size()!=1){showMessage("请选择教材。",false);return;}
$.post("/"+subject+"/training/selectbookpost",{"a":a.val(),"b":b.val(),"c":c.val(),"d":d.val(),"r":Math.random()},function(data){if(data.S==0){showMessage(data.M,true);closeBox();if(typeof(selectSABCallback)!="undefined"){selectSABCallback(data.D);}}else{showMessage(data.M,false);}});},loadLearnInfo:function(subject,pk,tp,holder){holder.loading().load("/"+subject+"/training/learninfo?a="+pk+"&b="+tp+"&r="+Math.random(),function(){holder.loaded();});},getTrainingParameter:function(){var p={TP:0,CP:0,AS:0,Flag:0,Data:"",Other:"",Degree:255,FDegree:255,TDegree:255,Cates:[],PointNos:[],UserIDs:[],UserID:g_emptyguid};var e0=$("#TP_TP"),e1=$("#TP_CP"),e2=$("#TP_AS"),e3=$("#TP_Data"),e4=$("#TP_Degree"),e5=$("#TP_Flag"),e9=$("#TP_Other");if(e0.size()==1&&$.isNumeric(e0.val())){var temp=parseInt(e0.val(),10);if(!isNaN(temp)){p.TP=temp;}}
if(e1.size()==1&&$.isNumeric(e1.val())){var temp=parseInt(e1.val(),10);if(!isNaN(temp)){p.CP=temp;}}
if(e2.size()==1&&$.isNumeric(e2.val())){var temp=parseInt(e2.val(),10);if(!isNaN(temp)){p.AS=temp;}}
if(e3.size()==1){p.Data=e3.val();}
if(e4.size()==1){p.Degree=parseInt(e4.val(),10);}else{e4=$("input[name='TP_Degree']:checked");if(e4.size()==1){p.Degree=parseInt(e4.val(),10);}}
if(e5.size()==1){p.Flag=parseInt(e5.val(),10);}else{$("input[name='TP_Flag']:checked").each(function(){p.Flag=p.Flag|parseInt($(this).val(),10);});}
$(".JYE_TP_CATE_QTY").each(function(){var ec=$(this);if($.isNumeric(ec.val())){var temp=parseInt(ec.val(),10);if(!isNaN(temp)){p.Cates.push([ec.data('cate'),temp]);}}});if(e9.size()==1){p.Other=e9.val();}
return p;},_autoExam:function(el,subject,p){el=$(el).prop("disabled",true).loading();$.post("/"+subject+"/training/autoexam",{"a":JSON.stringify(p),"r":Math.random()},function(data){el.prop("disabled",false).loaded();if(data.S==0){closeBox();Test2.openExam(subject,data.D);}else{showMessage(data.M,false);}});},autoExam:function(el,subject){var p=Test2.getTrainingParameter();Test2._autoExam(el,subject,p);},autoExamPoint:function(el,subject,no){var p=Test2.getTrainingParameter();p.TP=1;p.CP=1;p.AS=0;p.Other=no;Test2._autoExam(el,subject,p);},autoExamTopic:function(el,subject,no){var p=Test2.getTrainingParameter();p.TP=1;p.CP=2;p.AS=0;p.Other=no;Test2._autoExam(el,subject,p);},autoExamQues:function(el,subject,id,f){var p=Test2.getTrainingParameter();p.TP=1;p.CP=f;p.AS=0;p.Other=id;Test2._autoExam(el,subject,p);},autoExamError:function(el,subject,id,f){var p=Test2.getTrainingParameter();p.TP=5;p.CP=f;p.AS=0;p.Other=id;Test2._autoExam(el,subject,p);},autoRace:function(el,subject,id,f){var p=Test2.getTrainingParameter();p.TP=f;p.CP=f;p.AS=0;p.Other=id;Test2._autoExam(el,subject,p);},openExam:function(subject,id){var options={"title":"菁优网","title1":"","url":"/"+subject+"/training/openexam?a="+id+"&r="+Math.random(),"close":function(){Test2.clearTimer();if(typeof(refreshMe)!="undefined"){refreshMe();}},buttons:{"关闭":function(){closeBox(this);}}};Test2.clearTimer();openTestBox(options,function(){if($("#UEDO").val()=="1"){Test2.initDoing(subject);}else{Box.get().setOptions({"close":function(){Test2.clearTimer();}});Test2.initDone(subject);}});},deletePaper:function(subject,id,f){if(!window.confirm("是否确定删除该组卷？"))return;$.post("/"+subject+"/admin/paperdelete",{"a":id,"b":f,"r":Math.random()},function(data){if(data.S==0){alert(data.M);if(typeof(refreshMe)!='undefined'){refreshMe();}}else{showMessage(data.M,false);}});},testDoing:function(el,subject,id,f){el=$(el).prop("disabled",true).loading();if(typeof(f)=="undefined"){f=0;}
var options={"title":"菁优网","title1":"","url":"/"+subject+"/training/testdoing?a="+id+'&f='+f+"&r="+Math.random(),"close":function(){Test2.clearTimer();if(typeof(refreshMe)!="undefined"){refreshMe();}}};Test2.clearTimer();openTestBox(options,function(){el.prop("disabled",false).loaded();Test2.initDoing(subject);});},testAgain:function(el,subject,id){closeBox();Test2.testDoing(el,subject,id,1);},initDoing:function(subject){setTestBoxTitles();setTestBoxButtons();Test2.init('accDivDialog');Test2.setEvents();var spanTimer=$('#spanTimer');if(spanTimer.size()==1){Test2._asTimer=window.setInterval(function(){Test2.saveAnswers(subject,true);},60000);Test2._upTimer=spanTimer.countup({"begin":spanTimer.html(),"onFinish":function(){Test2._upTimer=null;}});}},initDone:function(subject){setTestBoxTitles();setTestBoxButtons();Test2.init('accDivDialog');Test2.initFieldtip();Test2.initSAnswers();Test2.showFieldtip(true);var spanDownTimer=$("#spanDownTimer");if(spanDownTimer.size()==1){Test2._downTimer=spanDownTimer.countdown({"end":spanDownTimer.text(),"onFinish":function(){$("button.JYE_CLASS_SCORE").prop("disabled",false);spanDownTimer.hide();Test2._downTimer=null;}});}},saveAnswers:function(subject,b){var answers=Test2.getAnswers();if(typeof(b)=="undefined"){b=false;}
if(!b){showProcess('正在保存答题，请稍候...');Test2.enabledButtons(true);}
$.post("/"+subject+'/training/testpost',{"a":$('#UEID').val(),"b":JSON.stringify(answers),"f":1,"r":Math.random()},function(data){if(!b){showMessage(data.M,data.S==0);hideProcess();Test2.enabledButtons(false);}});},submitAnswers:function(subject){var div=Test2.checkInputs();if(div==null){var answers=Test2.getAnswers();showProcess('正在提交答题，请稍候...');Test2.enabledButtons(true);Test2.clearTimer();var ueid=$('#UEID').val();$.post("/"+subject+'/training/testpost',{"a":ueid,"b":JSON.stringify(answers),"c":$("#UEBegin").val(),"d":$("#UETitle").val(),"f":0,"r":Math.random()},function(data){hideProcess();if(typeof(refreshMe)!="undefined"){refreshMe();}
showMessage(data.M,data.S==0);if(data.S==0){Play(data.D);getBoxContent().empty().loading().load("/"+subject+"/training/testdone?a="+ueid+"&f=2&r="+Math.random(),function(){$(this).loaded();Test2.initDone(subject);});}else{Test2.enabledButtons(false);}});}else{showMessage('您还有题目没有答完，不能提交。',false);Test2.scrollTo(div);}},enabledButtons:function(b){var s=getBoxButtonsSpan();if(s){s.children('button,input[type=button]').prop("disabled",b);}},clearTimer:function(){$("ul.JYE_CLASS_OANSWER").remove();if(Test2._asTimer!=null){window.clearInterval(Test2._asTimer);Test2._asTimer=null;}
if(Test2._upTimer!=null){Test2._upTimer.abort();Test2._upTimer=null;}
if(Test2._downTimer!=null){Test2._downTimer.abort();Test2._downTimer=null;}},favorite:function(el,s,a,t){var url='/'+s+'/api/addfavorite?t='+t+"&a="+a+"&r="+Math.random();var options={width:900,height:460,title:'添加收藏'};if(!jyeoo.isLogin()){openLoginUI(url,options);return;}
openBox(options,url,null,function(){$('#fname').width(550).attr('maxlength',20).focus();$('#fgroup').width(525).attr('maxlength',20);$('#fgroup').autocomplete({source:'/'+s+'/api/acfgroups?t='+$('#T').val()});var v=$.cookie('AF_Group_'+$('#T').val());if(v!=null&&v.length>0){$("#fgroup").val(unescape(v));}});}}
function openTreeNode(tree,pk){var a=tree.find("a[pk='"+pk+"']");if(a.size()==1){a.addClass('selected');var ul=a.next("ul");if(ul.size()==1){openTreeFirstNode(ul);}
openTreeThisNode(a);}else{openTreeFirstNode(tree);}}
function openTreeThisNode(a){var d=a.prev('div');if(d.size()==1){d.click();}
var ul=a.closest("ul");if(ul.size()==1){var pa=ul.prev("a");if(pa.size()==1){openTreeThisNode(pa)}else{var ps=ul.prev("span");if(ps.size()==1){openTreeThisNode(ps)}}}}
function openTreeFirstNode(holder){var a=$("a:first",holder);if(a.size()==1){var d=a.prev('div');if(d.size()==1){d.click();}
var ul=a.next("ul");if(ul.size()==1){openTreeFirstNode(ul);}}}
function toggleTrainingParameter(el){el=$(el);if(el.hasClass("i20")){el.removeClass("i20").addClass("i19").attr("title","点击隐藏训练设置");}else{el.removeClass("i19").addClass("i20").attr("title","点击展开训练设置");}
$("#dlTrainingParameter").toggle("slow");}
function tg(url,f,className){var options={width:610,height:360,title:"【菁优推广】",buttons:{"复制":function(){copyToClipboard("tg");},"关闭":function(){closeBox(this);}}};if(f==0){options.title="【菁优推广】";var html="<textarea id='tg' style=\"width:550px;height:210px;\">有不会做的数学题吗？上菁优网找找看。"+url+"</textarea>";}else if(f==1){options.title="【邀请注册】";var html="<textarea id='tg' style=\"width:550px;height:210px;\">菁优网是一个学习的好地方，我已经在菁优网安家了，您可以点击下面链接加入菁优网。"+url+"</textarea>";}else{options.title="【班级推广】";var html="<textarea id='tg' style=\"width:550px;height:210px;\">菁优网是一个学习的好地方，我已经在菁优网安家了，您可以点击下面链接加入“"+className+"”。"+url+"</textarea>";}
html+="<p style='color:red'>请点击“复制”以上信息，然后把复制的内容推广给您的QQ好友或QQ群。</p>";openBox(options);getBoxContent().empty().html(html);}
function copyToClipboard(id){try{var d=document.all(id).value;window.clipboardData.setData('text',d);showMessage("复制成功！")}catch(err){showMessage("复制失败！",false)}}
function delArticle(id,u){if(!window.confirm("是否确定删除该日志？"))return;if(typeof(u)=='undefined'){$.post("/article/delart",{"a":id,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}});});}else{$.post("/"+u+"/article/delart",{"a":id,"r":Math.random()},function(data){showResultObject(data,function(){if(typeof(refreshMe)!='undefined'){refreshMe();}});});}}
function showFavoriteAutocomplete(){var ac=$.data($('#fgroup').get(0),'Autocomplete');if(ac){ac.fixOffset();ac.getSuggestions('');}}
function postFavorite(el,s){var pa={'t':$('#T').val(),'a':$('#A').val(),'b':escape($('#fgroup').val()),'c':escape($('#fname').val()),'r':Math.random()};$.cookie('AF_Group_'+$('#T').val(),pa.b);$.post('/'+s+'/api/addfavoritepost',pa,function(data){if(data.S==0){showMessage(data.M);closeBox(el);}else{showMessage(data.M,false);}});};(function($){$.extend($.fn,{swapClass:function(c1,c2){var c1Elements=this.filter('.'+c1);this.filter('.'+c2).removeClass(c2).addClass(c1);c1Elements.removeClass(c1).addClass(c2);return this;},replaceClass:function(c1,c2){return this.filter('.'+c1).removeClass(c1).addClass(c2).end();},hoverClass:function(className){className=className||"hover";return this.hover(function(){$(this).addClass(className);},function(){$(this).removeClass(className);});},heightToggle:function(animated,callback){animated?this.animate({height:"toggle"},animated,callback):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"]();if(callback)
callback.apply(this,arguments);});},heightHide:function(animated,callback){if(animated){this.animate({height:"hide"},animated,callback);}else{this.hide();if(callback)
this.each(callback);}},prepareBranches:function(settings){if(!settings.prerendered){this.filter(":last-child:not(ul)").addClass(CLASSES.last);this.filter((settings.collapsed?"":"."+CLASSES.closed)+":not(."+CLASSES.open+")").find(">ul").hide();}
return this.filter(":has(>ul)");},applyClasses:function(settings,toggler){this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(event){if(this==event.target)
toggler.apply($(this).next());}).add($("a",this)).hoverClass();if(!settings.prerendered){this.filter(":has(>ul:hidden)").addClass(CLASSES.expandable).replaceClass(CLASSES.last,CLASSES.lastExpandable);this.not(":has(>ul:hidden)").addClass(CLASSES.collapsable).replaceClass(CLASSES.last,CLASSES.lastCollapsable);var hitarea=this.find("div."+CLASSES.hitarea);if(!hitarea.length)
hitarea=this.prepend("<div class=\""+CLASSES.hitarea+"\"/>").find("div."+CLASSES.hitarea);hitarea.removeClass().addClass(CLASSES.hitarea).each(function(){var classes="";$.each($(this).parent().attr("class").split(" "),function(){classes+=this+"-hitarea ";});$(this).addClass(classes);});}
this.find("div."+CLASSES.hitarea).click(toggler);},treeview:function(settings){settings=$.extend({cookieId:"treeview"},settings);if(settings.toggle){var callback=settings.toggle;settings.toggle=function(){return callback.apply($(this).parent()[0],arguments);};}
function treeController(tree,control){function handler(filter){return function(){toggler.apply($("div."+CLASSES.hitarea,tree).filter(function(){return filter?$(this).parent("."+filter).length:true;}));return false;};}
$("a:eq(0)",control).click(handler(CLASSES.collapsable));$("a:eq(1)",control).click(handler(CLASSES.expandable));$("a:eq(2)",control).click(handler());}
function toggler(){$(this).parent().find(">.hitarea").swapClass(CLASSES.collapsableHitarea,CLASSES.expandableHitarea).swapClass(CLASSES.lastCollapsableHitarea,CLASSES.lastExpandableHitarea).end().swapClass(CLASSES.collapsable,CLASSES.expandable).swapClass(CLASSES.lastCollapsable,CLASSES.lastExpandable).find(">ul").heightToggle(settings.animated,settings.toggle);if(settings.unique){$(this).parent().siblings().find(">.hitarea").replaceClass(CLASSES.collapsableHitarea,CLASSES.expandableHitarea).replaceClass(CLASSES.lastCollapsableHitarea,CLASSES.lastExpandableHitarea).end().replaceClass(CLASSES.collapsable,CLASSES.expandable).replaceClass(CLASSES.lastCollapsable,CLASSES.lastExpandable).find(">ul").heightHide(settings.animated,settings.toggle);}}
this.data("toggler",toggler);function serialize(){function binary(arg){return arg?1:0;}
var data=[];branches.each(function(i,e){data[i]=$(e).is(":has(>ul:visible)")?1:0;});$.cookie(settings.cookieId,data.join(""),settings.cookieOptions);}
function deserialize(){var stored=$.cookie(settings.cookieId);if(stored){var data=stored.split("");branches.each(function(i,e){$(e).find(">ul")[parseInt(data[i])?"show":"hide"]();});}}
this.addClass("treeview");var branches=this.find("li").prepareBranches(settings);switch(settings.persist){case"cookie":var toggleCallback=settings.toggle;settings.toggle=function(){serialize();if(toggleCallback){toggleCallback.apply(this,arguments);}};deserialize();break;case"location":var current=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase();});if(current.length){var items=current.addClass("selected").parents("ul, li").add(current.next()).show();if(settings.prerendered){items.filter("li").swapClass(CLASSES.collapsable,CLASSES.expandable).swapClass(CLASSES.lastCollapsable,CLASSES.lastExpandable).find(">.hitarea").swapClass(CLASSES.collapsableHitarea,CLASSES.expandableHitarea).swapClass(CLASSES.lastCollapsableHitarea,CLASSES.lastExpandableHitarea);}}
break;}
branches.applyClasses(settings,toggler);if(settings.control){treeController(this,settings.control);$(settings.control).show();}
return this;}});$.treeview={};var CLASSES=($.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"});})(jQuery);(function($){jQuery.fn.point=function(config){config=$.extend({'width':400,'height':500,'treeUrl':'','initUrl':'','single':true},config);return this.each(function(){var self=$(this);$('<div id="SR_'+self.prop('id')+'" style="padding:0;margin:2px 0;border:1px solid #ccc;min-height:25px;overflow:hidden;cursor:pointer"><img style="float:right;cursor:pointer" src="'+imageRootUrl+'images/search.gif" /><ol style="float:left;overflow:hidden"></ol></div>').click(function(){_open_tb(self);}).insertAfter(self);if(self.val().length>0){$.post(config.initUrl,{"a":self.val(),"r":Math.random()},function(data){_create_lis(self,data);});}});function _create_lis(tb,data){var ol=$('ol',$('#SR_'+$(tb).prop('id'))).empty(),nos='';if(typeof(data)=='undefined'){data=_get_tree_data();}
for(var i=0;i<data.length;i++){var li=$('<li style="display:block;float:left;margin:2px;padding:2px;width:47%" class="even"></li>').data('pk',data[i].pk).html(data[i].text).appendTo(ol);$('<img src="'+imageRootUrl+'images/del1.gif" style="margin:4px;float:right" />').prependTo(li).click(function(){$(this).parent().remove();var cnos='';$('li',ol).each(function(ii){if(ii===0){cnos=$(this).data('pk');}else{cnos+=','+$(this).data('pk');}});tb.val(cnos);});if(i===0){nos=data[i].pk;}else{nos+=','+data[i].pk;}}
tb.val(nos);closeBox();};function _get_tree_data(){var data=[];$('a.selected',$('#ulPOPTree')).each(function(i){var ta=$(this);data.push({'pk':ta.data('pk'),'text':ta.text()});});return data;};function _open_tb(tb){var options={'width':config.width,'height':config.height,'title':'【点击选择（'+(config.single?'单选':'多选')+'）】','buttons':{'确定':function(){_create_lis(tb);},'取消':function(){closeBox(this);}}};var ob=openBox(options,config.treeUrl,{'r':Math.random()},function(){var tree=$('#ulPOPTree').addClass('filetree').treeview({collapsed:true}),nos=tb.val().split(',');for(var i=0;i<nos.length;i++){var ta=tree.find("a[data-pk='"+nos[i]+"']");if(ta.size()==1){ta.addClass('selected');_open_this_top(ta);}else if(ta.size()==2){ta=tree.find("a[data-pk='"+nos[i]+"'][data-lv=3]").addClass('selected');_open_this_top(ta);}}
if(config.single){$('a',tree).click(function(){var ta=$(this);if(ta.next('ul').size()==0){$('a.selected',tree).removeClass('selected');ta.addClass('selected');}else{ta.prev('div').click();}});}else{$('a',tree).click(function(){var ta=$(this);if(ta.next('ul').size()==0){if(ta.hasClass('selected')){ta.removeClass('selected');}else{ta.addClass('selected');}}else{ta.prev('div').click();}});}});};function _open_this_top(a){var ul=a.closest("ul");if(ul.size()==1){var pa=ul.prev("a"),pd=pa.prev('div');if(pa.size()==1&&pd.hasClass('expandable-hitarea')){pd.click();_open_this_top(pa)};}}};})(jQuery);function searchSubmit(t){var dh=$("#searchform");dh.find("input:hidden[name='c']").val(t);dh.find("form").submit();}
function tz(el,url,f,t){var v=$(el).prev("input[type=text]").val();if($.isNumeric(v)){var i=parseInt(v,10),a=url.indexOf('?')==-1?'?':'&';if(i<f||i>t){alert('请输入您要跳转的页码（'+f+'-'+t+'）。');}else{window.location.href=url+a+"p="+i;}}else{alert('请输入您要跳转的页码（'+f+'-'+t+'）。');}}
function initLayout(id){try{$("#"+id).focus();$("#mathmlHelper").MathSearch(null,function(str){$("#"+id).val(str);$("input.JYE_QUES").click();});}catch(e){}
$('a.return-top').hide();$(window).scroll(function(){if($(this).scrollTop()==0){$('a.return-top').hide();}else{$('a.return-top').show();}});$.cookie('JYERN',Math.random());}
function initJavaScript(){$.getScript("/api/js?r="+Math.random(),function(){if(jyeoo.isLogin()){var a=$("a.JYE_LG").replaceWith('<a target="_blank" href="'+spaceRootUrl+'" rel="nofollow">进入空间</a><em class="v">|</em><a href="'+logoutUrl+'" rel="nofollow">退出</a>');}
if(typeof(initJavaScriptCallback)!='undefined'){initJavaScriptCallback();}});}
function requiredLogin(r){showMessage("您访问的功能需要登录，请输入邮箱和密码登录或注册新用户。",false);openLoginUI(r);}
function openNotice(id,t){var options={width:900,height:460,title:'【'+t+'】'};openBox(options,'/api/notice/'+id+'?r='+Math.random(),null,function(){});}
function toggleComments(a,s,id,e){var a=$(a),t=a.text();if(t.indexOf('显示')!=-1){a.text(t.replace('显示','隐藏'));if($('#divComments').text().length<=0){$('#divComments').load("/"+s+"/api/getcomment/"+id+"?a="+e+"&r"+Math.random());}}else{a.text(t.replace('隐藏','显示'));}
$('#divComments').toggle();$('#tbComment').focus();}
function submitComment(f,s,id,e){if($.trim($("#tbComment").val()).length<=0){showMessage("请输入您的评论内容。",false);$("#tbComment").focus();return;}
if(f&&!jyeoo.isLogin()){openLoginUI();}else{postComment(s,id,e);}}
function postComment(s,id,e){$("input[type='button'].bbg").prop("disabled",true);var url="/"+s+"/api/addcomment",p={"id":id,"a":$("#tbComment").val(),"b":e,"c":$("input[type='radio'][name='rbScore']:checked").val(),"r":Math.random()};$.post(url,p,function(data){$("input[type='button'].bbg").prop("disabled",false);showMessage(data.M,data.S==0);if(data.S==0){commentMe();}});}
function resizeBox(w,h,a){var b=Box.get();if(b){b.resize(w,h,a);}}
function resizeLogin(w,h){resizeBox(w,h,function(){$("#mf").height(h-60);});}
function survey(){var wsurvey=$.cookie('WSurvey');if(wsurvey){return;}
$('<div class="box-overlay"></div>').css({zIndex:1029,width:'100%',height:$(document).height(),display:'block'}).appendTo(document.body);$('<div class="box-wrapper" style="z-index:1030;display:block;top:50%;left:50%;margin-top:-100px;margin-left:-235px"><div style="padding:0;margin:0;width:470px;height:200px;background:url('+imageRootUrl+'images/wl_bg.png)\"><div style="line-height:60px;text-align:center;font-size:28px;color:#fff\">菁优在线调查</div><div style=\"padding:0 50px;text-align:left\"><div style=\"line-height:30px;font-size:14px;color:#fff\">菁优网每天都在竭尽全力为您提供更优质的服务！<br/>我们正在开展用户调查，希望您参与。</div><div style="text-align:center;margin:20px auto"><button style="height:35px;width:99px" onclick="surveyDO(this)">立即参与</button>&nbsp;&nbsp;&nbsp;<button style="height:35px;width:99px" onclick="surveyNO(this,0)">以后提醒</button>&nbsp;&nbsp;&nbsp;<button style="height:35px;width:99px" onclick="surveyNO(this,1)">不再提醒</button></div></div></div></div>').appendTo(document.body);}
function surveyDO(el){var div=$(el).closest('div');div.html('您是：<a href="http://www.wenjuan.com/s/R7FNb2" target="_blank" style="display:inline-block;background:#f5f5f5;padding:6px 30px" onclick="surveyOK(this,0)">老师</a>&nbsp;&nbsp;&nbsp;<a href="http://www.wenjuan.com/s/yYf6Zv" target="_blank" style="display:inline-block;background:#f5f5f5;padding:6px 30px" onclick="surveyOK(this,1)">学生</a>&nbsp;&nbsp;&nbsp;<a href="http://www.wenjuan.com/s/Yfqa2u" target="_blank" style="display:inline-block;background:#f5f5f5;padding:6px 30px" onclick="surveyOK(this,2)">家长</a>');}
function surveyNO(el,i){var todayAddOneDay=new Date();if(i==0){todayAddOneDay.setDate(todayAddOneDay.getDate()+1);}else{todayAddOneDay.setDate(todayAddOneDay.getDate()+123);}
$.cookie('WSurvey',"1",{expires:todayAddOneDay});$('div.box-overlay,div.box-wrapper').remove();}
function surveyOK(el,i){surveyNO(el,1);}
function welcomeHtml(titleLabel,label,desc,isFirst){var html='<div id="mssage"><div class="mask"></div><div class="mssage"><div class="title"><div class="msg-close"><a href="javascript:void(0);">×</a></div><span class="bold">菁优欢迎新伙伴</span><span class="label"'+(isFirst?' style="margin-right:15px;">':'>')+titleLabel+'</span></div><div class="con"><div class="desc"><div class="label">'+label+'</div><div class="prompt">菁优小秘密：'+desc+'</div></div><div class="reg'+(isFirst?'">':' reg2">')+'<a href="/account/register?t='+(isFirst?'2':'3')+'" class="reg-btn">快速注册</a><div class="fast-login">菁优会员，<a href="/account/login" onclick="openLoginUI();return false;">登录</a></div></div></div></div></div>';$('body').append(html);$('a.reg-btn').click(function(){$('#mssage').remove();});$('.fast-login a').click(function(){$('#mssage').remove();});$('.msg-close a').click(function(){location.reload();});$('#mssage').show();}
function fastLogin(anonId){var html='<div id="mssage"><div class="mask"></div><div class="mssage fast"><div class="title"><div class="msg-close"><a href="javascript:void(0);">×</a></div><span class="bold">菁优快速注册</span><span class="label">嗨小伙伴~菁优陪伴你这么久了，让我们在一起吧！</span></div><div class="login-desc">注册会员权利：免费查阅更多试题解析、专属学习成长记录、个性化组卷工具</div><div class="content"><form action="/Account/FastRegister" id="fastReg" method="post" class="form"><table><tr><td><div class="red" id="error"></div><input type="hidden" value="'+anonId+'" name="AnonID" /><input type="text" id="email" placeholder="可输入QQ邮箱快速注册" name="email" /></td></tr><tr><td><input type="password" name="password" maxlength="16" id="pwd" placeholder="输入密码（6-16位数字或字母）" /></td></tr><tr><td><input type="password" maxlength="16" id="cpwd" placeholder="密码确认" /></td></tr><tr><td class="verifyCode"><input type="text" name="verify" id="verify" placeholder="计算结果" /><img src="/api/captcha/'+anonId+'?r='+guid()+'&w=130" id="verifyImg" /><a href="javascript:void(0);" id="change">换一张</a></td></tr><tr><td class="protocol"><input type="checkbox" id="protocol" checked="checked" /><label for="protocol">已经阅读并同意<a href="/home/note">《菁优网服务条款》</a></label></td></tr><tr><td class="submit"><a href="javascript:void(0);">快速注册</a></td></tr></table></form><div class="right">菁优会员，<a href="/account/login" onclick="openLoginUI();$(\'#mssage\').remove();return false;">登录</a></div></div></div></div>';$("body").append(html);$('.msg-close a').click(function(){$(this).parent().parent().parent().parent().remove();});$('#change').click(function(){$('#verifyImg').attr('src','/api/captcha/'+anonId+'?r='+guid()+'&w=130');});$('.submit a').click(function(){if(!$('#protocol').attr('checked')){$('#error').html('请阅读服务条例');return false;}
if($('#pwd').val()!=$('#cpwd').val()){$('#error').html('两次输入的密码不一致');return false;}
var params=$('#fastReg').serialize();$('#error').html('注册中...');$.post('/Account/FastRegister',params,function(m){if(m.S==0){$('#error').html(m.M);}else{$('#mssage').remove();var identity='<div id="identity"><div class="mask"></div><div class="mssage bg-color"><div class="title"><div class="msg-close"><a href="javascript:void(0);">×</a></div><span class="bold">注册成功，菁优欢迎新伙伴</span></div><div class="identity"><div class="red" id="error"></div><span class="desc">您的身份是：</span><form id="utform" method="post"><span><input type="hidden" value="'+m.M+'" name="gid" /><input type="radio" name="UT" id="reacher" value="1" /><label for="reacher">老师</label><input type="radio" name="UT" id="student" value="2" checked="checked" /><label for="student">学生</label><input type="radio" name="UT" id="parent" value="3" /><label for="parent">家长</label></span><div class="submit"><input type="submit" value="确定" /></form></div></div></div></div>';$('#utform').submit(function(){var params=$('#fastReg').serialize();$.post('/Account/Identity',params,function(m){if(m.S==1){$('#identity').remove();}else{$('#error').html(m.M);}});});$("body").append(identity);$('#mssage').show();}});return false;});$('#mssage').show();}
function s4(){return Math.floor((1+Math.random())*0x10000).toString(16).substring(1);}
function guid(){return s4()+s4()+'-'+s4()+'-'+s4()+'-'+s4()+'-'+s4()+s4()+s4();}
function showThisTab(o,i){var el=$(o),ul=el.closest('ul');$('li',ul).css({'background':'#d9d5d5'});el.css({'background':'#fff'});$('.JYE_TAB_SUB').hide();$('.JYE_TAB_SUB_'+i).show();}
function ur_check(){$.post("/api/isremindOfVIP",{'r':Math.random()},function(data){if(data.S==0){var options={width:480,height:250,title:"【系统提醒】"};openBox(options,"/api/userremind?r="+Math.random());}});}
function ur_action(el,i){if(i==1){closeBox();ur_click(i,function(){window.location.href=wwwRootUrl+"recharge";});}else if(i==2){closeBox();ur_click(i,function(){var options={width:480,height:250,title:"【系统提醒】"};openBox(options,"/api/userremind2?r="+Math.random());});}else if(i==3){ur_choice();}}
function ur_click(i,fn){$.post("/api/userremindclick",{'a':i,'r':Math.random()},function(){fn();});}
function ur_choice(){var rb=$('input[name=ur_r2]:checked');if(rb.size()==1){var pa=rb.val(),pb='';if(pa=='4'){pb=rb.next('input').val();}
$.post("/api/userremindchoice",{'a':pa,'b':pb,'r':Math.random()},function(){closeBox();showMessage('非常感谢您的建议。');});}else{alert('请选择一项建议提交。');}}
function ur_other_focus(el){$(el).prev('input[type=radio]').prop('checked',true);}
$.fn.autoEmail=function(options){var defaults={domains:["126.com","163.com","qq.com","sina.com","yahoo.com","hotmail.com","sogou.com","138.com","139.com","21cn.com","live.com","gmail.com","sohu.com","foxmail.com"],bw:["com","cn","net"]}
var p=$.extend({},defaults,options||{});var d=p.domains;var h=p.bw;var s=this,sO=s.offset(),sW=s.outerWidth(),sH=s.outerHeight();$('body').append("<div class=\"jye_auto_email\"></div>");var a=$('.jye_auto_email').css({"left":sO.left,"top":sO.top+sH,"width":sW}).hide();s.keyup(function(e){var t=s.val(),l=t.length,r=[];if(l<3){a.hide();return;}
if(e.keyCode===38){var ei=a.find('li'),eic=a.find('li.cur'),eip;if(ei.length==0){return;}
if(eic.length==0||eic.is('li:first')){eip=ei.last();}else{eip=eic.prev();}
ei.removeClass('cur');eip.addClass('cur');s.val(eip.find('.auto_l').text()+eip.find('.auto_r').text());return;}else if(e.keyCode===40){var ei=a.find('li'),eic=a.find('li.cur'),ein;if(ei.length==0){return;}
if(eic.length==0||eic.is('li:last')){ein=ei.first();}else{ein=eic.next();}
ei.removeClass('cur');ein.addClass('cur');s.val(ein.find('.auto_l').text()+ein.find('.auto_r').text());return;}
else{r.push(/^\w+([-+.']\w+)*@\w+([-.]\w+)*\./,/^\w+([-+.']\w+)*@\w+([-.]\w+)*/,/^\w+([-+.']\w+)*@/,/^\w+([-+.']\w+)*/);var ir=[];if(r[0].test(t)){var tl=t.replace(r[0],""),tT=t.replace(r[2],"").split(".")[0],iT=false;for(var i=0;i<d.length;i++){if(d[i].split(".")[0]==tT&&d[i].split(".")[1].replace(tl,"").length<=d[i].split(".")[1]){ir.push(d[i].split(".")[1].replace(tl,""));iT=true;}}
if(!iT){for(var i=0;i<h.length;i++){for(var j=0;j<h[i].length;j++){var sS=h[i].substring(0,j);if(sS==tl){ir.push(h[i].replace(tl,""));}}}}}else if(r[1].test(t)){var tl=t.replace(r[2],""),iT=false;for(var i=0;i<d.length;i++){for(var j=0;j<d[i].length;j++){var sS=d[i].substring(0,j);if(sS==tl){ir.push(d[i].replace(tl,""));iT=true;break;}}}
if(!iT){for(var i=0;i<h.length;i++){ir.push("."+h[i]);}}}
else if(r[2].test(t)){for(var i=0;i<d.length;i++){ir.push(d[i]);}}
else if(r[3].test(t)){for(var i=0;i<d.length;i++){ir.push("@"+d[i]);}}
var html="";for(var i=0;i<ir.length;i++){html+="<li><span class=\"auto_l\">"+t+"</span><span class=\"auto_r\">"+ir[i]+"</span></li>";}
if(html!=""){html="<ul>"+html+"</ul>";a.html(html).css({"left":sO.left,"top":sO.top+sH+1,"width":sW}).show();a.find('li').bind("click",function(){s.val($(this).find('.auto_l').text()+$(this).find('.auto_r').text());a.hide();});}}});s.live("blur",function(){setTimeout(function(){a.hide()},300);});}
$.fn.placeholder=function(){if('placeholder'in document.createElement('input')){return;}else{$(this).each(function(index,element){var self=$(this),txt=self.attr('placeholder');self.wrap($('<div></div>').css({position:'relative',zoom:'1',border:'none',background:'none',padding:'none',margin:'none'}));var pos=self.position(),h=self.outerHeight(true),paddingleft=self.css('padding-left');var holder=$('<span></span>').text(txt).css({position:'absolute',left:pos.left,top:pos.top,height:h,"line-height":h+"px","padding-left":paddingleft,color:'#aaa',"background-color":"transparent"}).appendTo(self.parent());if(self.val()){holder.hide();}
self.focusin(function(e){holder.hide();}).focusout(function(e){if(!self.val()){holder.show();}});holder.click(function(e){holder.hide();self.focus();});});}}
var QuesCart={_subject:"math",init:function(subject,gc){if(typeof(subject)!='undefined'){QuesCart._subject=subject;}
if(typeof(gc)=='undefined'){gc=false;}
if($(".ques-cart").size()==1){$.post("/"+subject+"/paper/getquescartcounts",{r:Math.random()},function(data){if(data){if(data.S==0){QuesCart.refresh(data.D.xzCount,data.D.tkCount,data.D.jdCount);}
else{QuesCart.refresh(0,0,0);}}});}else{if($("#divQC").size()==0){$("<div id=\"divQC\"></div>").on("mouseout",function(event){QuesCart._hideUI(event);}).appendTo(document.body);}}
if(gc){QuesCart._loadbutton();QuesCart._loadUI();}else{QuesCart._loadUI();}},merge:function(el,subject,quesID){if(!jyeoo.isLogin()){openLoginUI();return;}
var tip=$("#"+quesID),tip_set=tip.offset();var cart=$(".ques-cart"),cart_set=cart.offset();if($(".ques-cart").size()==0){tip=$(".pt1",tip),cart=$("#divQC"),cart_set=cart.offset();}
if($(el).hasClass('added')){var fly=$("<div>"+tip.html()+"<div>").attr("id","ques-fly").css({"position":"absolute","z-index":"88","overflow":"hidden","text-align":"left"}).appendTo(document.body);fly.css({"width":cart.width(),"height":cart.height(),"top":cart_set.top,"left":cart_set.left,"background":"#FAFAFA","border":"1px solid #ccc"}).show().animate({"top":tip_set.top,"left":tip_set.left,"width":tip.width(),"height":tip.height()},800,"swing",function(){$(this).hide();$(this).remove();tip.css({"color":"#000"});$(el).removeClass('added');});$.post("/"+subject+"/paper/removequescart",{quesID:quesID,r:Math.random()},function(data){if(data){switch(data.S){case 0:{tip.css({"color":"#000"});$(el).removeClass('added');QuesCart.refresh(data.D.xzCount,data.D.tkCount,data.D.jdCount);QuesCart._loadUI();break;}
case 1:{openLoginUI();break;}
case 2:{tip.css({"color":"#000"});$(el).removeClass('added');break;}
default:{showMessage(data.M);break;}}}});}
else{var fly=$("<div>"+tip.html()+"<div>").attr("id","ques-fly").css({"position":"absolute","z-index":"88","overflow":"hidden","text-align":"left"}).appendTo(document.body);fly.css({"width":tip.width(),"height":tip.height(),"top":tip_set.top,"left":tip_set.left,"background":"#FAFAFA","border":"1px solid #ccc"}).show().animate({"top":cart_set.top+5,"left":cart_set.left,"width":cart.width(),"height":cart.height()},800,"swing",function(){$(this).hide();$(this).remove();tip.css({"color":"#909090"});$(el).addClass('added');});$.post("/"+subject+"/paper/addquescart",{quesID:quesID,r:Math.random()},function(data){if(data){switch(data.S){case 0:{tip.css({"color":"#909090"});$(el).addClass('added');QuesCart.refresh(data.D.xzCount,data.D.tkCount,data.D.jdCount);QuesCart._loadUI();break;}
case 1:{openLoginUI();break;}
case 3:{tip.css({"color":"#909090"});$(el).addClass('added');break;}
default:{showMessage(data.M);break;}}}});}},refresh:function(xzCount,tkCount,jdCount){var cart=$(".ques-cart");cart.find("#xzCount").text(xzCount);cart.find("#tkCount").text(tkCount);cart.find("#jdCount").text(jdCount);},clear:function(subject,before,after){var cof=window.confirm("确定清空试题篮所有试题？");if(cof){if(before){before();}
$.post("/"+subject+"/paper/clearcart",{r:Math.random()},function(data){if(data&&data.S==0){QuesCart.init(subject,true);showMessage(data.M);}
if(after){after();}
$(".added").removeClass("added").closest('.fieldtip').prev('fieldset').css({"color":"#000"});});}},load:function(subject,title,before,after){if(jyeoo.isLogin()){var options={width:900,height:$(window).height()*0.9-85,title:"【"+title+"】",open:function(){if(before){before();}},close:function(){if(after){after();}}};var o=openBox(options);o.box.find(".body-content").css({"overflow-y":"scroll"});var dialogContent=getBoxContent();dialogContent.loading("CT").load("/"+subject+"/paper/makepaper",{"r":Math.random()},function(){dialogContent.loaded();try{renderLatex(this);}catch(e){}});}
else{openLoginUI();}},noQues:function(){closeBox();var options={width:400,height:200,title:"【试题篮为空】"}
var o=openBox(options);o.setContent("<div style=\"text-align: center;line-height: 80px;font-size: 13px;\">当前试题篮为空，不能组卷，请添加试题后再进行组卷。<br/><input type=\"button\" value=\"确定\" class=\"btn-box-1\" onclick=\"closeBox(this)\"></div>");},_loadUI:function(){if($("#divQC").size()==1){$("#divQC").load("/paper/qcui",{"r":Math.random()},function(){var div=$(this),cont=$("#cont")[0];if(cont.clientHeight>cont.scrollHeight){div.css({"right":0});}else{div.css({"right":15});}
div.children("h2").on("mouseover",function(){QuesCart._showUI();});$("a[s]",div).on("click",function(){QuesCart.load($(this).attr("s"),$(this).attr("title"));});});}},_showUI:function(){if($("#divQC").size()==1){$("#divQC").children("ul").show()};},_hideUI:function(event){if(event&&$("#divQC").size()==1){if(event.toElement){if($(event.toElement).closest("div").prop("id")!="divQC"){$("#divQC").children("ul").hide();}}else if(event.relatedTarget){if($(event.relatedTarget).closest("div").prop("id")!="divQC"){$("#divQC").children("ul").hide();}}}},_find:function(ids,quesID){ids=ids||[];for(var i=0;i<ids.length;i++){if(ids[i]==quesID){return true;}}
return false;},_loadbutton:function(){$.post("/paper/getcart",{"r":Math.random()},function(data){if(data.S==0){$("fieldset[id].quesborder").each(function(){var fld=$(this),qid=fld.attr("id"),sb=fld.attr("s"),span=fld.next("span.fieldtip");if(span.size()==1){span.find("a[title=\"点击将把本题加入或移出您的试题篮\"]").remove();if(QuesCart._find(data.D[sb],qid)){$("<a title=\"点击将把本题加入或移出您的试题篮\" class='btn-ui add added'>试题篮</a>").click(function(){QuesCart.merge(this,sb,qid);}).appendTo(span);}else{$("<a title=\"点击将把本题加入或移出您的试题篮\" class='btn-ui add'>试题篮</a>").click(function(){QuesCart.merge(this,sb,qid);}).appendTo(span);}}});}else{showMessage(data.M);}});}};$.fn.autoCompany=function(a,b){$(this).each(function(i,el){var url='/company/accompany';var at=[];if(a!=null){at.push("a="+a);}
if(b!=null){at.push("b="+b);}
if(at.length>0){url+="?"+at.join("&");}
var ac=$('<input type=\"text\"/>').width($(el).width()).autocomplete({source:url,onSelect:function(s,d,e){$(el).val(d);}});$(el).width(20).before(ac).change(function(){ac.val($(this).find("option:selected").text());});});}
var seqFilter=0,subjectFilter='';function _getFilters(){var data=[];$('li',$('#olFilters')).each(function(){var li=$(this),filter=li.data('filter');data.push(filter);});return data;}
function _selectFilter(el,filter){var isEdit=filter!=null;if(isEdit){var options={width:600,height:250,title:"【筛选条件】",buttons:{"更新以上筛选条件":function(){_addFilter(this,el);},"关闭":function(){closeBox(this);}}};}else{var options={width:600,height:250,title:"【筛选条件】",buttons:{"加入以上筛选条件":function(){_addFilter(this);},"关闭":function(){closeBox(this);}}};}
openBox(options,'/'+subjectFilter+'/api/paperautoui?r='+Math.random(),null,function(box){var holder=box.getContent();if(isEdit){_initFilter(holder,filter);}else{$('#RPoint',holder).data('pks',[]).text('选择考点');$('#RCategory',holder).data('pks',[]).data('egt','').text('选择章节');}
$('#RRegion',holder).region('');});}
function _getFilterHolder(el){return Box.get(el).getContent();}
function _selectFilterPoint(el){el=$(el);var holder=_getFilterHolder(el),options={width:900,height:460,title:"【选择考点】",buttons:{"确定":function(){_selectFilterPointOK(this);},"取消":function(){closeBox(this);}}};openBox(options,'/'+subjectFilter+'/api/selectpoint',{'a':JSON.stringify($('#RPoint',holder).data('pks')),'r':Math.random()});}
function _selectFilterPointOK(el){var data=getSelected();if(data.PKs.length==0){alert("请选择一个考点。");}else{closeBox(el);var holder=Box.get().getContent();$('#RPoint',holder).data('pks',data.PKs).text(data.NMs[0]+'...');$('#RCategory',holder).data('pks',[]).data('egt','').text("选择章节");}}
function _selectFilterCategory(el){el=$(el);var holder=_getFilterHolder(el),ocategory=$('#RCategory',holder),pks=ocategory.data('pks'),egt=ocategory.data('egt');var options={width:900,height:460,title:"【选择章节】",buttons:{"确定":function(){_selectFilterCategoryOK(this);},"取消":function(){closeBox(this);}}};if(pks==null){pks="";}
if(egt==null){egt="";}
openBox(options,'/'+subjectFilter+'/api/selectcategory',{'a':JSON.stringify(pks),'b':egt,'r':Math.random()});}
function _selectFilterCategoryOK(el){var data=getSelected();if(data.PKs.length==0){alert("请选择一个教材章节或考点。");}else{closeBox(el);var holder=Box.get().getContent();$('#RPoint',holder).data('pks',[]).text("选择考点");$('#RCategory',holder).data('pks',data.PKs).data('egt',data.EGT).text(data.NMs[0]+'...');}}
function _addFilter(el,li){var holder=_getFilterHolder(el);var ol=$('#olFilters'),opoint=$('#RPoint',holder),ocategory=$('#RCategory',holder),pointpks=opoint.data('pks'),categorypks=ocategory.data('pks');var data={'Seq':seqFilter++,'Source3':$('input[name=RSource3]:checked',holder).val(),'Degree':$('input[name=RDegree]:checked',holder).val(),'DegreeName':$('input[name=RDegree]:checked',holder).next().text(),'Distribute':0,'Force':0,'Other':0,'Flags':[],'Points':[],'Categories':[],'Cates':[],'PointName':'','CategoryName':'','FlagsName':'','RegionName':'','EGT':'','Point':'','Category':'','Region':''},ftext='';var totalQty=0;$(".JYE_R_CATE_QTY",holder).each(function(){var ec=$(this);if($.isNumeric(ec.val())){var temp=parseInt(ec.val(),10);if(!isNaN(temp)){data.Cates.push([ec.data('cate'),temp]);totalQty+=temp;}}});if(totalQty<=0){alert('请输入有效的试题数量');return;}
$('input[name=RFlags]:checked',holder).each(function(){ftext+=$(this).next().text()+"；";data.Flags.push($(this).val());});if(ftext.length>0){data.FlagsName=ftext.substr(0,ftext.length-1);}
if(pointpks.length>0){data.PointName=opoint.text();data.Points=pointpks;if($('#RName').val().length<=0){$('#RName').val(data.PointName);}}
if(categorypks.length>0){data.CategoryName=ocategory.text();data.Categories=categorypks;if($('#RRFID').val()=='00000000-0000-0000-0000-000000000000'){$('#RRFID').val(categorypks[0].split('~')[1]);}
if($('#RName').val().length<=0){$('#RName').val(data.CategoryName);}}
if(data.Points.length<=0&&data.Categories.length<=0){alert('请选择一个章节或考点');return;}
data.EGT=ocategory.data('egt');data.Region=$('#RRegion',holder).next("input").val();data.RegionName=$('#RRegion',holder).val();$(el).prop('disabled',true).loading();$.post("/"+subjectFilter+"/api/vfilter",{"a":JSON.stringify(data),"r":Math.random()},function(rr){var ff=true;if(rr.S==1){ff=window.confirm(rr.M+"确定需要加入该条件？");}else if(rr.S==2){showMessage(rr.M);ff=false;}
if(ff){_addFilterO(data,li);closeBox(el);}}).done(function(){$(el).prop('disabled',false).loaded();});}
function _addFilterO(filter,li){var ol=$('#olFilters'),totalQty=0;$(filter.Cates).each(function(){totalQty+=this[1];});var text='题量：<b>'+totalQty+'</b>；';if(filter.DegreeName&&filter.DegreeName.length>0){text+='难度：<b>'+filter.DegreeName+'</b>；';}
if(filter.FlagsName&&filter.FlagsName.length>0){text+='来源：<b>'+filter.FlagsName+'</b>；';}
if(filter.PointName&&filter.PointName.length>0){text+='考点：<b>'+filter.PointName+'</b>；';}
if(filter.CategoryName&&filter.CategoryName.length>0){text+='章节：<b>'+filter.CategoryName+'</b>；';}
if(filter.RegionName&&filter.RegionName.length>0){text+='地区：<b>'+filter.RegionName+'</b>；';}
if(!li){li=$('<li style=\"margin:2px;padding:2px;border:1px dotted #ccc\"></li>').appendTo(ol);}
li.data('seq',filter.Seq).data('filter',filter).html('<input type="button" value="" style="margin-top:8px" class="smbtn tdelemsg fright" title="删除" onclick="$(this).closest(\'li\').remove()" /><input type="button" value="" style="margin-top:8px" class="smbtn edithis fright" title="修改" onclick="_editFilter(this)" />'+text+'<em class="red"></em>');}
function _editFilter(el){var li=$(el).closest('li');_selectFilter(li,li.data('filter'));}
function _initFilter(holder,filter){$(filter.Cates).each(function(){var cate=this[0],value=this[1];$(".JYE_R_CATE_QTY",holder).each(function(){var ec=$(this);if(ec.data('cate')==cate){ec.val(value);}});});$('input[name=RDegree][value='+filter.Degree+']',holder).prop('checked',true);$('input[name=RDistribute][value='+filter.Distribute+']',holder).prop('checked',true);$('input[name=RFlags]:checked',holder).each(function(){$(this).prop('checked',false);});$(filter.Flags).each(function(){$('input[name=RFlags][value='+this+']',holder).prop('checked',true);});$('input[name=ROther][value='+filter.Other+']',holder).prop('checked',true);var pointName=filter.PointName.length>0?filter.PointName:"请选择考点";$('#RPoint',holder).data('pks',filter.Points).text(pointName);var categoryName=filter.CategoryName.length>0?filter.CategoryName:"请选择章节";$('#RCategory',holder).data('pks',filter.Categories).data('egt',filter.EGT).text(categoryName);$('#RRegion',holder).val(filter.RegionName);$('#RRegion',holder).next("input").val(filter.Region)
$('input[name=RSource3][value='+filter.Source3+']',holder).prop('checked',true);}
function _clearFilterOfCP(el){var holder=$(el).closest('tr');$('#RPoint',holder).data('pks',[]).text('选择考点');$('#RCategory',holder).data('pks',[]).data('egt','').text('选择章节');}
$.fn.JyeAudio=function(){var player;if($("#JYE_AUDIO_JWPLAYER").size()==0){$(document.body).append($("<div id=JYE_AUDIO_JWPLAYER></div>"));player=jwplayer("JYE_AUDIO_JWPLAYER").setup({width:0,height:0,flashplayer:imageRootUrl+"/jwplayer/player.swf",events:{onPlay:function(state){var self=this;var duration=self.getDuration()*1000;var containerWidth=$(".jw-container-bar").width();$(".jw-play-bar").animate({width:containerWidth},duration,"linear");$(".jw-container-bar").bind("click",function(e){var seekWidth=e.clientX-$(this).offset().left;var seekPosition=seekWidth/containerWidth*duration/1000;$(".jw-play-bar").css({"width":seekWidth});$(".jw-play-bar").stop().animate({width:containerWidth},duration-seekPosition*1000,"linear");player.seek(seekPosition);})},onComplete:function(){$(".jw-container-bar").remove();}}});}
$(this).each(function(index,element){$(this).hover(function(){$(this).removeClass("cur");player.stop().load({file:$(element).data("file")}).play();$(".jw-container-bar").remove();if($(element).data("model")=="1"){$(element).after("<div class='jw-container-bar' style='width: 200px; height: 20px; background: #eee; border: 1px solid red; display: inline-block; position: absolute; float: left; margin: 12px 0 0 0;'>"
+"<div class='jw-play-bar' style='width: 0px; height: 20px; background: skyblue;'></div></div>");}
setTimeout(function(){$(element).addClass("cur");},300);setTimeout(function(){$(element).removeClass("cur");},3000);},function(){setTimeout(function(){$(element).removeClass("cur");},1500);});});}